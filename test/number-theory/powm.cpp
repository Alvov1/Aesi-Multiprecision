#include <gtest/gtest.h>
#include "../../Aesi.h"
#include "../benchmarks/benchmarks.h"

TEST(NumberTheory, PowerByModulo) {
    const auto timeStart = std::chrono::system_clock::now();

    Aesi512 b0 = "340282366920938463463370103832140840975", p0 = "3221225475", m0 = "339950141050392709210118888586112663551";
    EXPECT_EQ(Aesi < 512 > ::powm(b0, p0, m0), "242188462355016796506326460972064312371");
    Aesi512 b1 = "340282366920937254537843223041310457855", p1 = "4152412144", m1 = "340277169553477603280692196588073779168";
    EXPECT_EQ(Aesi < 512 > ::powm(b1, p1, m1), "60029882824320387061860541177526572577");
    Aesi512 b2 = "340281717918493467709983746410956718080", p2 = "4262453711", m2 = "340282366918462583458590823176539734016";
    EXPECT_EQ(Aesi < 512 > ::powm(b2, p2, m2), "166241065996741689193816594864568008704");
    Aesi512 b3 = "340282366920938463463374607431768211392", p3 = "4028567536", m3 = "340282366920938463462221685927161364480";
    EXPECT_EQ(Aesi < 512 > ::powm(b3, p3, m3), "79348468858045354254941204451296280576");
    Aesi512 b4 = "340199290171201906239764863559915798527", p4 = "4294934535", m4 = "339619700034677138865667858647163596807";
    EXPECT_EQ(Aesi < 512 > ::powm(b4, p4, m4), "190945401363700732035026529893014078999");
    Aesi512 b5 = "340261597733513957780485541721710524416", p5 = "4294934528", m5 = "338953159207418080134564096783067086848";
    EXPECT_EQ(Aesi < 512 > ::powm(b5, p5, m5), "118087720759252501250044903309519060992");
    Aesi512 b6 = "340282366920628978453557757166577778695", p6 = "2160197376", m6 = "297747719934472147355449730221654212607";
    EXPECT_EQ(Aesi < 512 > ::powm(b6, p6, m6), "57928875181475914237465337890967075425");
    Aesi512 b7 = "340282366287113163349539129860329308160", p7 = "4294443008", m7 = "340282204661661634250011215853758709760";
    EXPECT_EQ(Aesi < 512 > ::powm(b7, p7, m7), "38813761968132398604603721199146762240");
    Aesi512 b8 = "340282366920938463463338578634749247488", p8 = "4278386880", m8 = "339622945219902160277232182215714013695";
    EXPECT_EQ(Aesi < 512 > ::powm(b8, p8, m8), "333341121322987587452665281948710147831");
    Aesi512 b9 = "319180872486614983946280918507361140799", p9 = "4294967040", m9 = "340282366920938312347647155603121897471";
    EXPECT_EQ(Aesi < 512 > ::powm(b9, p9, m9), "242605114336884705500497766875037306587");
    Aesi512 b10 = "340271982332173156289549102266793852927", p10 = "4163372931", m10 = "297747233310146261775346733316556440063";
    EXPECT_EQ(Aesi < 512 > ::powm(b10, p10, m10), "239697327970302477233003760931426627547");
    Aesi512 b11 = "340282356782064470617754219073759084736", p11 = "4261513344", m11 = "340282366915986703306233086340761649151";
    EXPECT_EQ(Aesi < 512 > ::powm(b11, p11, m11), "312000446828687383165588324067882112339");
    Aesi512 b12 = "340282366920938461102191365996945604608", p12 = "4164935711", m12 = "340282366919700523424098234356119635967";
    EXPECT_EQ(Aesi < 512 > ::powm(b12, p12, m12), "97468202681093173268755220726194346809");
    Aesi512 b13 = "340282366920938463463374537063024033792", p13 = "3758096384", m13 = "340282042402385409462668642644496746495";
    EXPECT_EQ(Aesi < 512 > ::powm(b13, p13, m13), "53290272390312948071804296107263189626");
    Aesi512 b14 = "340282366911034943149091565236870184959", p14 = "4288543756", m14 = "340282366920783720958468438497033190913";
    EXPECT_EQ(Aesi < 512 > ::powm(b14, p14, m14), "31831287959824074494094319787582379094");
    Aesi512 b15 = "340282366920861092210919833985691418560", p15 = "4294836479", m15 = "170141183534745634093349748634288119808";
    EXPECT_EQ(Aesi < 512 > ::powm(b15, p15, m15), "152943670371834072508570671925505343488");
    Aesi512 b16 = "340282366861507670171155465451549490688", p16 = "4232036448", m16 = "329651138469264312705628427181399998719";
    EXPECT_EQ(Aesi < 512 > ::powm(b16, p16, m16), "166719213828605669472919223434275734462");
    Aesi512 b17 = "340282366920938463426481119284617543679", p17 = "4294837245", m17 = "339950217110666672240183291809579925759";
    EXPECT_EQ(Aesi < 512 > ::powm(b17, p17, m17), "248339961938836228265170153500058810260");
    Aesi512 b18 = "340282361850336062587350489592374493183", p18 = "4269836273", m18 = "340282366920628978748701167538101551103";
    EXPECT_EQ(Aesi < 512 > ::powm(b18, p18, m18), "247427145960671437473780361614290202142");
    Aesi512 b19 = "340282366920938444573908957428096958975", p19 = "4261543809", m19 = "340282366920938463463374607431767162880";
    EXPECT_EQ(Aesi < 512 > ::powm(b19, p19, m19), "223637069157424417476278886297590759935");
    Aesi512 b20 = "340282366920938454018641641761180483584", p20 = "4262396157", m20 = "340116213421620090598440921119204573168";
    EXPECT_EQ(Aesi < 512 > ::powm(b20, p20, m20), "231476390231591077951789595623433384336");
    Aesi512 b21 = "340282365653307206048250032802739781376", p21 = "4294836239", m21 = "340282366920919120650260790957158957025";
    EXPECT_EQ(Aesi < 512 > ::powm(b21, p21, m21), "117644024555309964971288329605382960701");
    Aesi512 b22 = "340282366920861092210919306331779235840", p22 = "4026597383", m22 = "340282364385666277228892416139954479104";
    EXPECT_EQ(Aesi < 512 > ::powm(b22, p22, m22), "10713627511155090396967609823168364544");
    Aesi512 b23 = "340282366920628978453625319888378658812", p23 = "4294901760", m23 = "340282290861902447996417243681684193248";
    EXPECT_EQ(Aesi < 512 > ::powm(b23, p23, m23), "191350596849387162887012368283971124864");
    Aesi512 b24 = "340282366920938463315800654842091800575", p24 = "4026777600", m24 = "340240828546070184842346363461201559551";
    EXPECT_EQ(Aesi < 512 > ::powm(b24, p24, m24), "23427068683975867853522421327192355067");
    Aesi512 b25 = "340282366920938462282782987264112721918", p25 = "4294959104", m25 = "340282356779772309484835218222462533632";
    EXPECT_EQ(Aesi < 512 > ::powm(b25, p25, m25), "208678536903017550265612312104438595584");
    Aesi512 b26 = "340262895807699615046797828823085744128", p26 = "3766025990", m26 = "340282366920861092210921522895748332543";
    EXPECT_EQ(Aesi < 512 > ::powm(b26, p26, m26), "64172493901475581739248659803490512734");
    Aesi512 b27 = "340282366920938463463374607431768211448", p27 = "4294959135", m27 = "340282366845461597767374466366359732224";
    EXPECT_EQ(Aesi < 512 > ::powm(b27, p27, m27), "285260086283875379103218287969598177280");
    Aesi512 b28 = "334969998197550017945934343374934900751", p28 = "4293920767", m28 = "340116213422084318962010833539800497664";
    EXPECT_EQ(Aesi < 512 > ::powm(b28, p28, m28), "233367085309087690416312817909571998447");
    Aesi512 b29 = "340277179694682324835520572089444597760", p29 = "4262460431", m29 = "340282285805536359603622681187362801663";
    EXPECT_EQ(Aesi < 512 > ::powm(b29, p29, m29), "268233102554279753786580304454376085579");
    Aesi512 b30 = "340282366920938463463370103832140840975", p30 = "3221225475", m30 = "339950141050392709210118888586112663551";
    EXPECT_EQ(Aesi < 512 > ::powm(b30, p30, m30), "242188462355016796506326460972064312371");
    Aesi512 b31 = "340282366920937254537843223041310457855", p31 = "4152412144", m31 = "340277169553477603280692196588073779168";
    EXPECT_EQ(Aesi < 512 > ::powm(b31, p31, m31), "60029882824320387061860541177526572577");
    Aesi512 b32 = "340281717918493467709983746410956718080", p32 = "4262453711", m32 = "340282366918462583458590823176539734016";
    EXPECT_EQ(Aesi < 512 > ::powm(b32, p32, m32), "166241065996741689193816594864568008704");
    Aesi512 b33 = "340282366920938463463374607431768211392", p33 = "4028567536", m33 = "340282366920938463462221685927161364480";
    EXPECT_EQ(Aesi < 512 > ::powm(b33, p33, m33), "79348468858045354254941204451296280576");
    Aesi512 b34 = "340199290171201906239764863559915798527", p34 = "4294934535", m34 = "339619700034677138865667858647163596807";
    EXPECT_EQ(Aesi < 512 > ::powm(b34, p34, m34), "190945401363700732035026529893014078999");
    Aesi512 b35 = "340261597733513957780485541721710524416", p35 = "4294934528", m35 = "338953159207418080134564096783067086848";
    EXPECT_EQ(Aesi < 512 > ::powm(b35, p35, m35), "118087720759252501250044903309519060992");
    Aesi512 b36 = "340282366920628978453557757166577778695", p36 = "2160197376", m36 = "297747719934472147355449730221654212607";
    EXPECT_EQ(Aesi < 512 > ::powm(b36, p36, m36), "57928875181475914237465337890967075425");
    Aesi512 b37 = "340282366287113163349539129860329308160", p37 = "4294443008", m37 = "340282204661661634250011215853758709760";
    EXPECT_EQ(Aesi < 512 > ::powm(b37, p37, m37), "38813761968132398604603721199146762240");
    Aesi512 b38 = "340282366920938463463338578634749247488", p38 = "4278386880", m38 = "339622945219902160277232182215714013695";
    EXPECT_EQ(Aesi < 512 > ::powm(b38, p38, m38), "333341121322987587452665281948710147831");
    Aesi512 b39 = "319180872486614983946280918507361140799", p39 = "4294967040", m39 = "340282366920938312347647155603121897471";
    EXPECT_EQ(Aesi < 512 > ::powm(b39, p39, m39), "242605114336884705500497766875037306587");
    Aesi512 b40 = "340271982332173156289549102266793852927", p40 = "4163372931", m40 = "297747233310146261775346733316556440063";
    EXPECT_EQ(Aesi < 512 > ::powm(b40, p40, m40), "239697327970302477233003760931426627547");
    Aesi512 b41 = "340282356782064470617754219073759084736", p41 = "4261513344", m41 = "340282366915986703306233086340761649151";
    EXPECT_EQ(Aesi < 512 > ::powm(b41, p41, m41), "312000446828687383165588324067882112339");
    Aesi512 b42 = "340282366920938461102191365996945604608", p42 = "4164935711", m42 = "340282366919700523424098234356119635967";
    EXPECT_EQ(Aesi < 512 > ::powm(b42, p42, m42), "97468202681093173268755220726194346809");
    Aesi512 b43 = "340282366920938463463374537063024033792", p43 = "3758096384", m43 = "340282042402385409462668642644496746495";
    EXPECT_EQ(Aesi < 512 > ::powm(b43, p43, m43), "53290272390312948071804296107263189626");
    Aesi512 b44 = "340282366911034943149091565236870184959", p44 = "4288543756", m44 = "340282366920783720958468438497033190913";
    EXPECT_EQ(Aesi < 512 > ::powm(b44, p44, m44), "31831287959824074494094319787582379094");
    Aesi512 b45 = "340282366920861092210919833985691418560", p45 = "4294836479", m45 = "170141183534745634093349748634288119808";
    EXPECT_EQ(Aesi < 512 > ::powm(b45, p45, m45), "152943670371834072508570671925505343488");
    Aesi512 b46 = "340282366861507670171155465451549490688", p46 = "4232036448", m46 = "329651138469264312705628427181399998719";
    EXPECT_EQ(Aesi < 512 > ::powm(b46, p46, m46), "166719213828605669472919223434275734462");
    Aesi512 b47 = "340282366920938463426481119284617543679", p47 = "4294837245", m47 = "339950217110666672240183291809579925759";
    EXPECT_EQ(Aesi < 512 > ::powm(b47, p47, m47), "248339961938836228265170153500058810260");
    Aesi512 b48 = "340282361850336062587350489592374493183", p48 = "4269836273", m48 = "340282366920628978748701167538101551103";
    EXPECT_EQ(Aesi < 512 > ::powm(b48, p48, m48), "247427145960671437473780361614290202142");
    Aesi512 b49 = "340282366920938444573908957428096958975", p49 = "4261543809", m49 = "340282366920938463463374607431767162880";
    EXPECT_EQ(Aesi < 512 > ::powm(b49, p49, m49), "223637069157424417476278886297590759935");
    Aesi512 b50 = "340282366920938454018641641761180483584", p50 = "4262396157", m50 = "340116213421620090598440921119204573168";
    EXPECT_EQ(Aesi < 512 > ::powm(b50, p50, m50), "231476390231591077951789595623433384336");
    Aesi512 b51 = "340282365653307206048250032802739781376", p51 = "4294836239", m51 = "340282366920919120650260790957158957025";
    EXPECT_EQ(Aesi < 512 > ::powm(b51, p51, m51), "117644024555309964971288329605382960701");
    Aesi512 b52 = "340282366920861092210919306331779235840", p52 = "4026597383", m52 = "340282364385666277228892416139954479104";
    EXPECT_EQ(Aesi < 512 > ::powm(b52, p52, m52), "10713627511155090396967609823168364544");
    Aesi512 b53 = "340282366920628978453625319888378658812", p53 = "4294901760", m53 = "340282290861902447996417243681684193248";
    EXPECT_EQ(Aesi < 512 > ::powm(b53, p53, m53), "191350596849387162887012368283971124864");
    Aesi512 b54 = "340282366920938463315800654842091800575", p54 = "4026777600", m54 = "340240828546070184842346363461201559551";
    EXPECT_EQ(Aesi < 512 > ::powm(b54, p54, m54), "23427068683975867853522421327192355067");
    Aesi512 b55 = "340282366920938462282782987264112721918", p55 = "4294959104", m55 = "340282356779772309484835218222462533632";
    EXPECT_EQ(Aesi < 512 > ::powm(b55, p55, m55), "208678536903017550265612312104438595584");
    Aesi512 b56 = "340262895807699615046797828823085744128", p56 = "3766025990", m56 = "340282366920861092210921522895748332543";
    EXPECT_EQ(Aesi < 512 > ::powm(b56, p56, m56), "64172493901475581739248659803490512734");
    Aesi512 b57 = "340282366920938463463374607431768211448", p57 = "4294959135", m57 = "340282366845461597767374466366359732224";
    EXPECT_EQ(Aesi < 512 > ::powm(b57, p57, m57), "285260086283875379103218287969598177280");
    Aesi512 b58 = "334969998197550017945934343374934900751", p58 = "4293920767", m58 = "340116213422084318962010833539800497664";
    EXPECT_EQ(Aesi < 512 > ::powm(b58, p58, m58), "233367085309087690416312817909571998447");
    Aesi512 b59 = "340277179694682324835520572089444597760", p59 = "4262460431", m59 = "340282285805536359603622681187362801663";
    EXPECT_EQ(Aesi < 512 > ::powm(b59, p59, m59), "268233102554279753786580304454376085579");
    Aesi512 b60 = "340282366911044614555648447090190709759", p60 = "2614075360", m60 = "324331628436373015035827870745021612095";
    EXPECT_EQ(Aesi < 512 > ::powm(b60, p60, m60), "321308343561923855798635763926656739221");
    Aesi512 b61 = "340282361850336064911640234083693363199", p61 = "4292870144", m61 = "340277174624080533098656447199962996727";
    EXPECT_EQ(Aesi < 512 > ::powm(b61, p61, m61), "99163972616564212548124075484381357561");
    Aesi512 b62 = "340282364385637848580359689036369888255", p62 = "3228630529", m62 = "340282366920928792056835704796880044016";
    EXPECT_EQ(Aesi < 512 > ::powm(b62, p62, m62), "224895594760573080057101367770110602559");
    Aesi512 b63 = "340282366920938463463374607431231340544", p63 = "4160750079", m63 = "170146375757326859862645280231119650815";
    EXPECT_EQ(Aesi < 512 > ::powm(b63, p63, m63), "24910572981143788971613813233771388604");
    Aesi512 b64 = "340282366762520824024180112230859931648", p64 = "4294967040", m64 = "340282366920899777837146939298179579904";
    EXPECT_EQ(Aesi < 512 > ::powm(b64, p64, m64), "296788396968999906848410558214205472768");
    Aesi512 b65 = "340282366841710300949110269838224261120", p65 = "4278190080", m65 = "340282366915986703306233086336464584704";
    EXPECT_EQ(Aesi < 512 > ::powm(b65, p65, m65), "258644231797530889913750262848776306688");
    Aesi512 b66 = "340271982327221696038428535782461411327", p66 = "4294852607", m66 = "340282365663191232442635938000672923616";
    EXPECT_EQ(Aesi < 512 > ::powm(b66, p66, m66), "242248090282170461766659024475051275519");
    Aesi512 b67 = "340281089129132833667595137259881398271", p67 = "4039145486", m67 = "340282366918462583412474525941481078784";
    EXPECT_EQ(Aesi < 512 > ::powm(b67, p67, m67), "251734169798359909736989918535001636865");
    Aesi512 b68 = "340282366920628978453553271159136452607", p68 = "4291034111", m68 = "170805797438554951271019019305710780415";
    EXPECT_EQ(Aesi < 512 > ::powm(b68, p68, m68), "80753144702431381130139248546548724923");
    Aesi512 b69 = "340282366920938463463374607429620727808", p69 = "4292869127", m69 = "337623910929368782242998636980171964415";
    EXPECT_EQ(Aesi < 512 > ::powm(b69, p69, m69), "218677222025751705255625011738538361297");

    Logging::addRecord(testing::UnitTest::GetInstance()->current_test_info()->name(),
                       std::chrono::system_clock::to_time_t(timeStart),
                       (std::chrono::system_clock::now() - timeStart).count());;
}

TEST(NumberTheory, PowerByModuloDifferentPrecision) {
    {
        Aesi < 1088 > b = "28793048285076456849987446542225640606265293220424618926480394046852138561538086130369569608684063330929781666943229330417701929475565397707259833702883043470999551";
        Aesi < 512 > p = "115792089237316195423570984637466491971220643441904616453966139132392564064256";
        Aesi < 960 > m = "3121745573184599697933326506281725673488773347286281875230608438576618760350198733928207019107265771354178414155544146158372110284329493119107072";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "1286836696482081140314397122337047802239648832365860657790787629905517321601268779927276198715392010886217965690239863155957940369407301606440961");
    }
    {
        Aesi < 1024 > b = "13407807929942597099574024998205840962979609646775214065885217437705972534855967544372580674851683074864211086053989552841267536093376052211498616578637824";
        Aesi < 320 > p = "1461144825407731620530278796051549176363871109120";
        Aesi < 1088 > m = "57586096570152913699974892898380567793532123114264532903689671329430453039077084285042523271276718195461686303871834374018121798118265098455642255034105415086374911";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "42564106683845511631498521655651469549617377615639896347806059028514635640668676047385020376805556204505439186893523848592594858588418496205410276056718237776373363");
    }
    {
        Aesi < 832 > b = "169230328010303040104789128755083054127923732022899807468809113220112422547386864369054315593043409610121512739103191611736064";
        Aesi < 576 > p = "497323235483449955863837968976039649428411832473088307844669270716132876116016121249792";
        Aesi < 1152 > m = "247330401473104534060502521019647190023501929512482129665273875166691446055489595470830922917634503889644788508017545565362328433794782571145209373548919260370265165831077888";
        EXPECT_EQ(Aesi < 1152 > ::powm(b, p, m), "55563801833497614384214020422460598554623823483619729019925294819559150020877392844322847134219839231707844120715314831750084637976551028897860408786676578680286523449933824");
    }
    {
        Aesi < 960 > b = "3121748550315992231381597229793166305748598142664971150859156959625255946730528303924882532078483283251973661136740982331408518095280372176650240";
        Aesi < 384 > p = "6277101735386680763835789422575079056027526123990582034431";
        Aesi < 1152 > m = "247330401473104534060502521019647190035131349101211839914063056092897225106531867170316401061243044989597671426016139339351365034306751209967546155101893167916606772131921920";
        EXPECT_EQ(Aesi < 1152 > ::powm(b, p, m), "81719070410459849960569981916324100519056896839959044892894431146871324540741163585133503747046455790127428872500488867769790021865305550496403957465924800510614288444948480");
    }
    {
        Aesi < 1280 > b = "4562440617622195218641171605700291324893228507248169712010403018870352467554953240717694236549538278384784914953641235843336234018860399735369724823327235821862467883605650806576529468624470015";
        Aesi < 640 > p = "2135987035920910082395021706169551291856702963489018373226286118570173662888770803297219548020736";
        Aesi < 832 > m = "169230328010303641331690318839301489908704318298266917863074585613767653132821522082282056581704256758716025351527221690367999";
        EXPECT_EQ(Aesi < 1280 > ::powm(b, p, m), "86903993352159273726024218988856437095769082421817875105919859082069441199773555795349230693287571703209411791651700879814984");
    }
    {
        Aesi < 1024 > b = "13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946551499689575296532480";
        Aesi < 192 > p = "79228162514264337593536610303";
        Aesi < 960 > m = "3121748550315992231360443438791916829103813019291528218834738035592802360069254495148035631253882535571969826625245784523250285503002430152900607";
        EXPECT_EQ(Aesi < 1024 > ::powm(b, p, m), "167648241824788377642688807762960368919909878668492835130280239250424359095899275731967252385659208273069031431040545192513035811684446348615715");
    }
    {
        Aesi < 1088 > b = "57586096570152913699974892898380567793532123114264532903689671329431520511113834798455284506659101071783731920229799439845945850001882401931509362202255401183871999";
        Aesi < 512 > p = "115792089237316195323137357245424007756186726618908221633794085042696929411079";
        Aesi < 1088 > m = "57586096570152913699974892898380567793532123114264532903689671329431521032595044740083720782129802971518987656109067457577065805510327036016891142675844838996312064";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "39425654526107845777534757940252133690690500017817066812291843029593672275529926593423190550750419392824945760638655783123482275062105795307978947593311022434229247");
    }
    {
        Aesi < 1216 > b = "1062275985633534197379176413104937254659186235454063846398888276400807119721704485478325004530458571337778658972493002030693158675305414478819039957533174703887662541670777916848340992";
        Aesi < 640 > p = "2135987035920910082395021706166182121269310692382319393235388725851535576021070777467889459920895";
        Aesi < 1088 > m = "57586096570152913699974892898198858112458221391627201951717670195843110692423215225013348232334643149490638175301464937724654427531985572965205873684212146126192640";
        EXPECT_EQ(Aesi < 1216 > ::powm(b, p, m), "52805426313587856528879255792073388076887345584000467946817726849023223060397538582575761013521794712684325354210839369723119298304221565695114180849032759143825408");
    }
    {
        Aesi < 1088 > b = "57586096570152913699974892898369211025110932197875125602495188346570005377472866204388234174818635354569564200889698953789765988726003027997523531343887529083404287";
        Aesi < 320 > p = "1461501637330902918202446892677015653779542900224";
        Aesi < 896 > m = "726838724295606890549323807886857785319052665529389133028993772601213061236285265346505431407524514935530011739795894737435778042822656";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "601472881595829681311768882757452224394957009400235631029169398952722344346849528336215179275540154188455637790277240554377393333075969");
    }
    {
        Aesi < 1088 > b = "57586096570152913699974892898380567790824437866099674642382626227729290853457899158662024907939881506075021535205136185077090799549253229283575389860596013917536255";
        Aesi < 640 > p = "2135987035920910082395021706169552114602704522356652769947041607822219725780640550022962086936575";
        Aesi < 1216 > m = "1062275985633534197379176413104937254659186235454063846398882987953056797732912870155929093947289413222951585417336150507998249973690913492664547841982744437630392702545436270131150847";
        EXPECT_EQ(Aesi < 1216 > ::powm(b, p, m), "283134526851189100852240159489524993577982883156885921970936798893693737332300616573823900258478833841330461507282794088468469403324860657710499652143142023883259032958999851114066538");
    }
    {
        Aesi < 1216 > b = "1062275985633534197379176413098233350694217985486845501860948811928112156625225383756074256777023821120951484760158914493906870028350298551175190050077976241237449780259849816638488576";
        Aesi < 512 > p = "115792089237316195411016781724986755903953896272547229400021678868641165213680";
        Aesi < 1216 > m = "1062275981676247773809503868136896918344831194891962260779498837775798222235348883782564132704528202055379948047400744675847606966191432593882325306975554164754257180661652547409281024";
        EXPECT_EQ(Aesi < 1216 > ::powm(b, p, m), "367212410660349293556324601728065904864465591684104661804455312007376321346007876135761176000158090074118654491979754235578022146043364297442338651781033978643260258822572193433518080");
    }
    {
        Aesi < 960 > b = "3121748550315992231381597229793166305748598142664971150859156959625364501814188287858092129876928928165586101747365020360195509581413690642530303";
        Aesi < 320 > p = "1461490486963620564874634758333721921125397561407";
        Aesi < 1024 > m = "13407807929942597099574024998205846127479365820592393360225555645457668635093529159860903375341547980544332366780321199574129889216939184158328232821653504";
        EXPECT_EQ(Aesi < 1024 > ::powm(b, p, m), "7558784404007254179446202013527355286311652987153519874299029622893115829321653711359187394756810497438550966453777044499316481698080147321408978876891135");
    }
    {
        Aesi < 768 > b = "39402006196394474837777590534119765060075285035223558459942780075314432264177467154966809113375959303628109239026687";
        Aesi < 576 > p = "497323236409786642155375666128591555276287530920617488043514648350609880299066793918463";
        Aesi < 1088 > m = "57586096570152913699974892898380567793532123113003668714652434414310560084205278948179183670766658714471158035184897947977991938123264469667722602304733233878663167";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "53750455023425484251590451536225101504065350384994488259671724003959955961949211487858823711077412591697854622831147179340278924737999949165432908832771319540000734");
    }
    {
        Aesi < 1280 > b = "4562440617622195218641171603857536234648335268849363357831014348506247558079881512662571649039502557186432406335067778684252157262718916566987175660155911237399442436210624017667798014472740864";
        Aesi < 640 > p = "2135986017402921915152204728370999543107810658702551030548942207690795127816630233948373376827392";
        Aesi < 1152 > m = "247330401444311485775426064169659743585941065205122699668893200193986361758817106118602877866534999448796070226567555134413719075795233475073408356551927274789783246120943615";
        EXPECT_EQ(Aesi < 1280 > ::powm(b, p, m), "71264946182442896501111445551292324403933274599945950715454908540527922469326567258770589455295819618860258960659949847068266956542322357308123242207639532834185396056696466");
    }
    {
        Aesi < 1280 > b = "4562440617622195218641171605700291269974847226203682213701117539962914098952224014513569647584321690996277108355474989175092994780793822144284304711061489162472004594364639851026124360325783552";
        Aesi < 320 > p = "1461501637325586006220545169224667791414811230207";
        Aesi < 896 > m = "726838724295606890549323807888004534353641360687318060281490199180639288113397923326191050713763565560762521606115062206082772981776384";
        EXPECT_EQ(Aesi < 1280 > ::powm(b, p, m), "573085401894547166516877089750418966107279455078782547574800402627962088464692182111276871789969819688769511207932354915166690109030400");
    }
    {
        Aesi < 480 > b = "3121748550315992231381597229793166305748598142664971150859156959625371710550212583666156829730731959273136122399535007900960059727307972915757055";
        Aesi < 320 > p = "2135987035920910082395021706162812127935916862413832022724610311826625179005870538981309914546175";
        Aesi < 640 > m = "4562440617622195218640930072105102759976280368016596111333964076248887830702467076404883052044767627261231899229783937719891733282240435898076393107055969243524110323809126937240242683992080385";
        EXPECT_EQ(Aesi < 1280 > ::powm(b, p, m), "3396749894941605567831558406665805237674303820831119787937916887240792038060789413629083710682912253029088102726959216836998201987219031808219220339092822669721545043136606135209869992714867180");
    }
    {
        Aesi < 544 > b = "57586096570152913699974892898380567793532123114264532903689671329431521032595029198732582976297235615849444076665958162731003003801430757313358381913574131959332863";
        Aesi < 128 > p = "340282366920938463462221685927698235391";
        Aesi < 352 > m = "9173994463960286046443162164402583662021073836291238949753181765400165020333784676326739523463851183964160";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "8496265141364276510549253504550958504593295349553205713283722962166149202410888719081730365656949040611327");
    }
    {
        Aesi < 544 > b = "57586096570126726575111723763420462275872887157041955765434720652460973026996094501591379035333238741921668244439571835034263330682834391902557627243711423173361664";
        Aesi < 192 > p = "6277101735386680763835789402925256812487578508664202330111";
        Aesi < 352 > m = "9173994463960286046443283580745179406236995174978840555009139830923789269379663223601348843851423005278207";
        EXPECT_EQ(Aesi < 1088 > ::powm(b, p, m), "8449383671881346854682386324156350997362796256241924704879071052081985865750377553306262699731034223553189");
    }
    {
        Aesi < 512 > b = "6705540660275246620721309291863484558478952238370444308981358783218494017381979628051137499602159771407679446130198812434899206834823096954266170001719295";
        Aesi < 256 > p = "115792089237316195423570985008687907853269984341122010381030857224757109063680";
        Aesi < 480 > m = "1560874275180709825825036330226249521870799204282033968819009471706473530105504092595615095458664085308162799507413625103179160037443212572360703";
        EXPECT_EQ(Aesi < 1024 > ::powm(b, p, m), "499534077147171048777912604673035861718505971691592024813454518650480734076475862290024616309509451981592688309382739971702047474758790939649091");
    }
    {
        Aesi < 416 > b = "169230328010303641331690318856389386196071598838855992136870091590247882556495704531248437872567112920983350278405945366151168";
        Aesi < 192 > p = "6277101735386323951912612933237401844610011085078448308223";
        Aesi < 608 > m = "1062275985633534197379176413104937254659186235454063846398888276400807119721704485478325004530458571337778658972493002030693158675305414473110049186709335179654518663890820291041951743";
        EXPECT_EQ(Aesi < 1216 > ::powm(b, p, m), "747010848843677046214727000262387707994984622979618490501109772079728919179161077526702803786705859329999612677945347174518196555969887238227623990389320927325076719623193015838862584");
    }
}