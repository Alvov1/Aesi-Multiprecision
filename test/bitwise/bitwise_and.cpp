#include <gtest/gtest.h>
#include "../../Aesi.h"
#include "../benchmarks/benchmarks.h"

TEST(Bitwise, AND) {
    const auto timeStart = std::chrono::system_clock::now();

    Aesi < 96 > m0 = 807495886205862545ULL, m1 = 1699422046959474079ULL;
    EXPECT_EQ(m0 & m1, 221957416007270545);
    Aesi < 96 > m2 = 6020843877211540190ULL, m3 = 2820365921155811108ULL;
    EXPECT_EQ(m2 & m3, 216825446434865668);
    Aesi < 96 > m4 = 496287893612905849ULL, m5 = 5537849818418819518ULL;
    EXPECT_EQ(m4 & m5, 342872881284284728);
    Aesi < 96 > m6 = 165318749836852092ULL, m7 = 8926412243518722244ULL;
    EXPECT_EQ(m6 & m7, 162222513246474308);
    Aesi < 96 > m8 = 5264123772951786426ULL, m9 = 2852134561985560693ULL;
    EXPECT_EQ(m8 & m9, 73394618703708208);
    Aesi < 96 > m10 = 4205707638274056784ULL, m11 = 1984793449478590286ULL;
    EXPECT_EQ(m10 & m11, 1876070303540478528);
    Aesi < 96 > m12 = 9010636561450167420ULL, m13 = 3553584763672728327ULL;
    EXPECT_EQ(m12 & m13, 3530846306868133892);
    Aesi < 96 > m14 = 7253126117003635320ULL, m15 = 5828253018003978680ULL;
    EXPECT_EQ(m14 & m15, 4656727529491015736);
    Aesi < 96 > m16 = 5594942297097490178ULL, m17 = 3233208432597169874ULL;
    EXPECT_EQ(m16 & m17, 901890218922100226);
    Aesi < 96 > m18 = 2440701276938964359ULL, m19 = 5097711526480249732ULL;
    EXPECT_EQ(m18 & m19, 44495591782220164);
    Aesi < 96 > m20 = 4961542391997891365ULL, m21 = 8957960641716920054ULL;
    EXPECT_EQ(m20 & m21, 4922452551855735332);
    Aesi < 96 > m22 = 4772516690168967743ULL, m23 = 6418922195999336602ULL;
    EXPECT_EQ(m22 & m23, 4616192505617063962);
    Aesi < 96 > m24 = 4879230276091144715ULL, m25 = 578663735221075192ULL;
    EXPECT_EQ(m24 & m25, 1831862171346952);
    Aesi < 96 > m26 = 8051937268484037076ULL, m27 = 6554740396428438499ULL;
    EXPECT_EQ(m26 & m27, 5383516828817426880);
    Aesi < 96 > m28 = 1305644231050943800ULL, m29 = 150888236037976121ULL;
    EXPECT_EQ(m28 & m29, 150888179985289272);
    Aesi < 96 > m30 = 7826866948865614259ULL, m31 = 5886922966844117361ULL;
    EXPECT_EQ(m30 & m31, 4652935318167683377);
    Aesi < 96 > m32 = 5066295933064978557ULL, m33 = 5341944783702619361ULL;
    EXPECT_EQ(m32 & m33, 4756364474424238177);
    Aesi < 96 > m34 = 3825298084329337048ULL, m35 = 7308700973399774971ULL;
    EXPECT_EQ(m34 & m35, 2667309961348550872);
    Aesi < 96 > m36 = 3150148350274398294ULL, m37 = 565366596855016744ULL;
    EXPECT_EQ(m36 & m37, 256864782519511040);
    Aesi < 96 > m38 = 6815390237134941828ULL, m39 = 2482521022620068152ULL;
    EXPECT_EQ(m38 & m39, 148936578777311232);

    Aesi < 96 > r0 = 4344279557358000924ULL, r1 = 3724904829868641935ULL;
    r0 &= r1; EXPECT_EQ(r0, 3459188053502855692);
    Aesi < 96 > r2 = 1112834019237028400ULL, r3 = 3625059836849560394ULL;
    r2 &= r3; EXPECT_EQ(r2, 162275426907193856);
    Aesi < 96 > r4 = 4335728930570490046ULL, r5 = 8093173946221350096ULL;
    r4 &= r5; EXPECT_EQ(r4, 3458934186923540624);
    Aesi < 96 > r6 = 1822629055601206922ULL, r7 = 146367862301361490ULL;
    r6 &= r7; EXPECT_EQ(r6, 2252109051331586);
    Aesi < 96 > r8 = 7297995515302880473ULL, r9 = 2998472088715638536ULL;
    r8 &= r9; EXPECT_EQ(r8, 2379220292686947336);
    Aesi < 96 > r10 = 5710777460057741934ULL, r11 = 1838971091260172745ULL;
    r10 &= r11; EXPECT_EQ(r10, 648589087707760712);
    Aesi < 96 > r12 = 1815093428787458358ULL, r13 = 6410954302032519131ULL;
    r12 &= r13; EXPECT_EQ(r12, 1742893983790600466);
    Aesi < 96 > r14 = 875664792203268108ULL, r15 = 7995211383371396853ULL;
    r14 &= r15; EXPECT_EQ(r14, 875018171160104964);
    Aesi < 96 > r16 = 9023990112834530628ULL, r17 = 2214624467228169116ULL;
    r16 &= r17; EXPECT_EQ(r16, 2034401282399273220);
    Aesi < 96 > r18 = 5713056118405738636ULL, r19 = 5675644662191157970ULL;
    r18 &= r19; EXPECT_EQ(r18, 5638735454455083136);
    Aesi < 96 > r20 = 2359788090022102190ULL, r21 = 7785696910268559981ULL;
    r20 &= r21; EXPECT_EQ(r20, 2309222920311865388);
    Aesi < 96 > r22 = 7370909568331285304ULL, r23 = 4014661568115332139ULL;
    r22 &= r23; EXPECT_EQ(r22, 2738946274675392552);
    Aesi < 96 > r24 = 5955384016749281757ULL, r25 = 8864715236630449151ULL;
    r24 &= r25; EXPECT_EQ(r24, 5910343392629440989);
    Aesi < 96 > r26 = 1256363509734577876ULL, r27 = 3140580802002726154ULL;
    r26 &= r27; EXPECT_EQ(r26, 73488679326712832);
    Aesi < 96 > r28 = 4818806868701803866ULL, r29 = 2102472921918857446ULL;
    r28 &= r29; EXPECT_EQ(r28, 3750780444663874);
    Aesi < 96 > r30 = 4315386286410443642ULL, r31 = 2453081287190472343ULL;
    r30 &= r31; EXPECT_EQ(r30, 2450820652626878994);
    Aesi < 96 > r32 = 7020035880803699723ULL, r33 = 7392799005541845695ULL;
    r32 &= r33; EXPECT_EQ(r32, 6919830308045719563);
    Aesi < 96 > r34 = 717042233482679795ULL, r35 = 2358561338398651631ULL;
    r34 &= r35; EXPECT_EQ(r34, 50456625176122595);
    Aesi < 96 > r36 = 1699264370831645387ULL, r37 = 2269418300545444664ULL;
    r36 &= r37; EXPECT_EQ(r36, 1663121155613002248);
    Aesi < 96 > r38 = 8415579626477377023ULL, r39 = 1758383484602008231ULL;
    r38 &= r39; EXPECT_EQ(r38, 1171498939003748519);

    Aesi512 y0 = 4889091353405609314; EXPECT_EQ(y0 & 0, 0); Aesi512 y1 = -5651070512456491307; EXPECT_EQ(y1 & 0, 0);
    Aesi512 y2 = 8716999149386587222; EXPECT_EQ(y2 & 0, 0); Aesi512 y3 = 3990093180733831391; EXPECT_EQ(y3 & 0, 0);
    Aesi512 y4 = -600115849107061037; EXPECT_EQ(y4 & 0, 0); Aesi512 y5 = 5971190278122453016; EXPECT_EQ(y5 & 0, 0);
    Aesi512 y6 = 3882719951867855839; EXPECT_EQ(y6 & 0, 0); Aesi512 y7 = 3455443969755678518; EXPECT_EQ(y7 & 0, 0);
    Aesi512 y8 = -3766894349432610843; EXPECT_EQ(y8 & 0, 0); Aesi512 y9 = -5791857218894865903; EXPECT_EQ(y9 & 0, 0);
    Aesi512 y10 = -338534766738000611; EXPECT_EQ(y10 & 0, 0); Aesi512 y11 = 5102817375810074387; EXPECT_EQ(y11 & 0, 0);
    Aesi512 y12 = 5476206818927814191; EXPECT_EQ(y12 & 0, 0); Aesi512 y13 = -947360454527944509; EXPECT_EQ(y13 & 0, 0);
    Aesi512 y14 = 7367263158822837235; EXPECT_EQ(y14 & 0, 0); Aesi512 y15 = 7983868794538809353; EXPECT_EQ(y15 & 0, 0);
    Aesi512 y16 = 4964001329143328906; EXPECT_EQ(y16 & 0, 0); Aesi512 y17 = -2083543087607023197; EXPECT_EQ(y17 & 0, 0);
    Aesi512 y18 = 4767057428498046618; EXPECT_EQ(y18 & 0, 0); Aesi512 y19 = 7093268892832568583; EXPECT_EQ(y19 & 0, 0);
    Aesi512 y20 = 4932144590764335822; EXPECT_EQ(y20 & 0, 0); Aesi512 y21 = 2129523306274277923; EXPECT_EQ(y21 & 0, 0);
    Aesi512 y22 = 8744895838014776233; EXPECT_EQ(y22 & 0, 0); Aesi512 y23 = 6357409700796211810; EXPECT_EQ(y23 & 0, 0);
    Aesi512 y24 = -1568025427859683472; EXPECT_EQ(y24 & 0, 0); Aesi512 y25 = 1955290413378850634; EXPECT_EQ(y25 & 0, 0);
    Aesi512 y26 = -3467502238642711691; EXPECT_EQ(y26 & 0, 0); Aesi512 y27 = -3814588671259119772; EXPECT_EQ(y27 & 0, 0);
    Aesi512 y28 = 4824738721222873185; EXPECT_EQ(y28 & 0, 0); Aesi512 y29 = -1835318120755538411; EXPECT_EQ(y29 & 0, 0);
    Aesi512 y30 = 2147927829914714909; EXPECT_EQ(y30 & 0, 0); Aesi512 y31 = 3200786312241374990; EXPECT_EQ(y31 & 0, 0);
    Aesi512 y32 = -483873791020330186; EXPECT_EQ(y32 & 0, 0); Aesi512 y33 = -7999797217494852664; EXPECT_EQ(y33 & 0, 0);
    Aesi512 y34 = 5436292966102924275; EXPECT_EQ(y34 & 0, 0); Aesi512 y35 = 607615924805583424; EXPECT_EQ(y35 & 0, 0);
    Aesi512 y36 = 2856731699000776584; EXPECT_EQ(y36 & 0, 0); Aesi512 y37 = -2976940612831152377; EXPECT_EQ(y37 & 0, 0);
    Aesi512 y38 = -4552915678136467928; EXPECT_EQ(y38 & 0, 0); Aesi512 y39 = -5371039465969672271; EXPECT_EQ(y39 & 0, 0);
    Aesi512 y40 = 1530606965224422562; EXPECT_EQ(y40 & 0, 0); Aesi512 y41 = -995241498352202847; EXPECT_EQ(y41 & 0, 0);
    Aesi512 y42 = -1895238691991552268; EXPECT_EQ(y42 & 0, 0); Aesi512 y43 = -2386612473149815406; EXPECT_EQ(y43 & 0, 0);
    Aesi512 y44 = -7381958681118134228; EXPECT_EQ(y44 & 0, 0); Aesi512 y45 = 4752526470796438865; EXPECT_EQ(y45 & 0, 0);
    Aesi512 y46 = 3193989889132937698; EXPECT_EQ(y46 & 0, 0); Aesi512 y47 = 8118840548867685223; EXPECT_EQ(y47 & 0, 0);
    Aesi512 y48 = -1634236269771840043; EXPECT_EQ(y48 & 0, 0); Aesi512 y49 = 5152688280230008107; EXPECT_EQ(y49 & 0, 0);
    Aesi512 y50 = 4740142746211585342; EXPECT_EQ(y50 & 0, 0); Aesi512 y51 = 3445462967643173198; EXPECT_EQ(y51 & 0, 0);
    Aesi512 y52 = 7794992459357947569; EXPECT_EQ(y52 & 0, 0); Aesi512 y53 = 2683466666324270632; EXPECT_EQ(y53 & 0, 0);
    Aesi512 y54 = 531129792006888313; EXPECT_EQ(y54 & 0, 0); Aesi512 y55 = -1866077217373908775; EXPECT_EQ(y55 & 0, 0);
    Aesi512 y56 = 6039725184101265805; EXPECT_EQ(y56 & 0, 0); Aesi512 y57 = 2310906701521457706; EXPECT_EQ(y57 & 0, 0);
    Aesi512 y58 = 5729261014028876522; EXPECT_EQ(y58 & 0, 0); Aesi512 y59 = -7400848010369953160; EXPECT_EQ(y59 & 0, 0);

#ifdef NDEBUG
    Logging::addRecord("Bitwise_AND",
                       std::chrono::system_clock::to_time_t(timeStart),
                       (std::chrono::system_clock::now() - timeStart).count());
#else
    std::cout << "Time estimated: " << (std::chrono::system_clock::now() - timeStart).count() << " ms." << std::endl;
#endif /* NDEBUG */
}

TEST(Bitwise, DifferentPrecisionAND) {
    {
        Aesi < 352 > first = "47918100704688271616510892901896495939684775967819086025692665489843469630154.";
        Aesi < 320 > second = "1246552767469185488369315672782586803099001260876365595544.";
        EXPECT_EQ(first & second, "63265630511398538051734786837389409541781770448454812296.");

        Aesi < 416 > third = "-2712851849813795876473894203693216551277095849299267883186805995876570769508.";
        Aesi < 256 > forth = "5025966419100860005186510584140202319139378932746821186817.";
        third &= forth; EXPECT_EQ(third, "-298887574535333987425999962481295589067152285831190159360.");
    }
    {
        Aesi < 384 > first = "105689775021334539029195604294427772358806783597527347021279626311430725746130.";
        Aesi < 320 > second = "-1631521213519025852066033495069405659373463412438537445362.";
        EXPECT_EQ(first & second, "1581559343782919440241933793567337675701557326122863599058.");

        Aesi < 352 > third = "19034654236501506123513786949783827171264394879250262350363731658589247763920.";
        Aesi < 256 > forth = "-4414172728114580253539739258458339423549599096611792912540.";
        third &= forth; EXPECT_EQ(third, "392902908919218238822468993607183072496345732303252652176.");
    }
    {
        Aesi < 384 > first = "-84601016485426487739925962922940945815535545137227910708808420562114153037588.";
        Aesi < 192 > second = "-3464688745883777214034285435041296070915645502287961668979.";
        EXPECT_EQ(first & second, "-3366605476056886819127484728032187940147031520987705523472.");

        Aesi < 384 > third = "108118680767685688562843398718740146420063556415732209120137282391084644790871.";
        Aesi < 288 > forth = "-5529032125927241912301850904493029165794752815639114171854.";
        third &= forth; EXPECT_EQ(third, "3933536206295635546627998214098606375213419654447764619334.");
    }
    {
        Aesi < 320 > first = "-67509776649795157188660631535110358750394376915431790825321351771739107527957.";
        Aesi < 224 > second = "-2213557262838202074326927147373647149025569000266088879778.";
        EXPECT_EQ(first & second, "-2011209461152208123689227222089466985165405348512418792448.");

        Aesi < 384 > third = "65438625985710669262697939685956891818011588441239673117535833347144814626671.";
        Aesi < 224 > forth = "3682188877200957459492935829206756325800850357550041510976.";
        third &= forth; EXPECT_EQ(third, "3681997250933693682306856878753849700853037708337211966528.");
    }
    {
        Aesi < 384 > first = "-37257822860769724606225738303392242180057489338626540569259345063498606546129.";
        Aesi < 192 > second = "-1440529728381926639720985030204862109300160503508639160062.";
        EXPECT_EQ(first & second, "-789337352373235078486699373507142888376180361078080799952.");

        Aesi < 448 > third = "-92821781271558589773119897427398601081733781940175193740840686434077912020277.";
        Aesi < 288 > forth = "-2676019274780722228107991584349383345440866391990445273155.";
        third &= forth; EXPECT_EQ(third, "-1106731633009921877637651851909530365583302839742610747393.");
    }
    {
        Aesi < 352 > first = "-50221359586948519268772494943479422668311690401449706396443758444411087502202.";
        Aesi < 320 > second = "3282523773774765745973185086498432584871668212590080799630.";
        EXPECT_EQ(first & second, "-98379619957997473845648921270248959460534222091502760714.");

        Aesi < 384 > third = "-98198345264946009435878554953523130237579202734093938844499018012422336900343.";
        Aesi < 224 > forth = "416585764281262209084031404546097587034620052703898806171.";
        third &= forth; EXPECT_EQ(third, "-413034688714698520435133109171535898435961398649867478163.");
    }
    {
        Aesi < 448 > first = "38542268969937762826851131190776405138594118569845981982694650437595070404120.";
        Aesi < 224 > second = "712441078972935800139869505114493064713200842286161734351.";
        EXPECT_EQ(first & second, "613779546184717713828956316071533399647873101527272915464.");

        Aesi < 320 > third = "41722077260148894980558097965984980617691903138025686784063041478662126743670.";
        Aesi < 288 > forth = "4079548630199993313050097413096753032133548726675113241097.";
        third &= forth; EXPECT_EQ(third, "885800796628795282998417618891841484558089015938956042240.");
    }
    {
        Aesi < 416 > first = "45911340345284579518991929572019091752773134460354321078504831685471947114890.";
        Aesi < 192 > second = "-1818681171027481454013217559300426296142280285035232124508.";
        EXPECT_EQ(first & second, "1815280092925572317511613731494917783534300150274407417864.");

        Aesi < 384 > third = "49473334202021664511587251403196331015570878326964652378559643231216400669114.";
        Aesi < 288 > forth = "-75122063562294682864730618937406489749441843544833415362.";
        third &= forth; EXPECT_EQ(third, "49067207324660443346820996810044768949864825622794868866.");
    }
    {
        Aesi < 448 > first = "51294030613108634854052804803705843847076166182401598946609448284341465954919.";
        Aesi < 320 > second = "-2081723393253515649328037322837460448496015994150341342226.";
        EXPECT_EQ(first & second, "1575423562060944917596640935041711348435626106680348258306.");

        Aesi < 320 > third = "-109389735426376347932832859561501325961864971642185139672794339019652576084193.";
        Aesi < 192 > forth = "-2351297191690001114275664903136885731371654977550022945526.";
        third &= forth; EXPECT_EQ(third, "-1930992330492500772815558885300877416570416527517052829920.");
    }
    {
        Aesi < 384 > first = "-82413493836841549880117956307447858969283724024600198764027186247485603140552.";
        Aesi < 224 > second = "1261873714108351833035903180633921464683585059020547679902.";
        EXPECT_EQ(first & second, "-844453868921079441815735690587356633135927166878807048840.");

        Aesi < 352 > third = "-21383830021428991813827809231471254738390656126845676422412161555155418639632.";
        Aesi < 256 > forth = "378880439662357519929810762300639904269578399243660665210.";
        third &= forth; EXPECT_EQ(third, "-347895195011833460416231068086266025464442015733478596880.");
    }
    {
        Aesi < 448 > first = "-79463395220194836053826252472558279914418114963630238448902899027697282197346.";
        Aesi < 256 > second = "1216754089330787086607093457501812205489442501126726940270.";
        EXPECT_EQ(first & second, "-392797763318188234715994627891179737885814558254388225634.");

        Aesi < 320 > third = "56939419921400168601016848755477578465010247155913845065666025352636236584283.";
        Aesi < 320 > forth = "1880848215078270187519762824467884928019848504358400891590.";
        third &= forth; EXPECT_EQ(third, "1866968731140226013208588864741620472855610117267191238722.");
    }
    {
        Aesi < 448 > first = "-17849347383402428789475560117571637457045014172071324146450499611055944154885.";
        Aesi < 288 > second = "-3852950874685553075143401173095133485864404565889824526514.";
        EXPECT_EQ(first & second, "-3337970218208110657612074077013487238735514098785621905408.");

        Aesi < 352 > third = "-89752570023646226700089363826862133905342108835203509706478066121629750091034.";
        Aesi < 224 > forth = "-5021025872533538710191027677610890478035487430153760254335.";
        third &= forth; EXPECT_EQ(third, "-208480941159676606301757820326543696016271038150746376474.");
    }
    {
        Aesi < 384 > first = "-22323002559781857228837920231933006163622656011698609229845986828760741579970.";
        Aesi < 256 > second = "4197650786545086540356432376437493269687484658707542271981.";
        EXPECT_EQ(first & second, "-1056034692438801217923341867267318618056619626269955327168.");

        Aesi < 384 > third = "-44674558432232823844747613511413837308621151784209847901477114572513525778077.";
        Aesi < 256 > forth = "634932354100174305549250609997329990563136521432970647770.";
        third &= forth; EXPECT_EQ(third, "-226905217485744841463151383741998606072412624335315681432.");
    }
    {
        Aesi < 384 > first = "-110002050308947325686560854877496002561424299121388594994176774778361413724661.";
        Aesi < 256 > second = "208529564990531101273927871794422799867893262907088597983.";
        EXPECT_EQ(first & second, "-12260882562813238136875156499862298602758508996606845397.");

        Aesi < 448 > third = "-95882301126832309625005128705245833917770528683490683056591142284885794301119.";
        Aesi < 320 > forth = "-2637066144399550196769988546408691762995900994090263185592.";
        third &= forth; EXPECT_EQ(third, "-1815240974118692496516828178944608072700587744693691416760.");
    }
    {
        Aesi < 416 > first = "-37731464298969353133548956105861579521055328378966063741740021521685865871499.";
        Aesi < 320 > second = "2507126156020374815996230928137593221549566183483123463792.";
        EXPECT_EQ(first & second, "-3363652254855208811452227557051153357170282512331583488.");

        Aesi < 448 > third = "51235953368549643076577927155787255121131602682559303696508116230963853883070.";
        Aesi < 224 > forth = "-2757286696776502987271129606230339063954874944288950848494.";
        third &= forth; EXPECT_EQ(third, "786361985097117130201858527718902325002528432166668337838.");
    }
    {
        Aesi < 384 > first = "-105892387669655328748297154316416796420554234488429034257526871129446444747278.";
        Aesi < 192 > second = "-210594235726726690346662589540488144452174687971154013758.";
        EXPECT_EQ(first & second, "-384748003887796250529362353915543702097824438513830414.");

        Aesi < 320 > third = "-107663473678837006180730182357817240541503195620598917979448645866748217912522.";
        Aesi < 192 > forth = "1076543692599487298259765300601266136382032443868972546499.";
        third &= forth; EXPECT_EQ(third, "-263925953519310168179646696008268755740982729462962677954.");
    }
    {
        Aesi < 384 > first = "-97979719617225906839366739512176258016508169547015918670737810122697032292262.";
        Aesi < 224 > second = "-2094526337318026918473758475391214001939393351288679025396.";
        EXPECT_EQ(first & second, "-24663623725783116533641412516037038754514355014283248292.");

        Aesi < 320 > third = "-16975463927955372950525781660713754825739423905518055876496789238035500170686.";
        Aesi < 256 > forth = "-1776472503085616115741720066674060019716012941753755756970.";
        third &= forth; EXPECT_EQ(third, "-199329559296694101193082043691953324223741480444609227178.");
    }
    {
        Aesi < 352 > first = "56981023644176702212904856734018944131943119924454229897128333982206466902619.";
        Aesi < 224 > second = "-4987398728872412154555955771781763782522352492979666260819.";
        EXPECT_EQ(first & second, "4953250099941140139910983778612727848772957216090471170643.");

        Aesi < 320 > third = "-63106215304914219828892761794328853201275560828619796747820810801403523284859.";
        Aesi < 288 > forth = "-5282528241520076464263745941971656685511974093667037923634.";
        third &= forth; EXPECT_EQ(third, "-59768098133805154855528146537242129420439767288575723826.");
    }
    {
        Aesi < 416 > first = "-93304861739042168668748785581211856923917794986141155363533136311129188366643.";
        Aesi < 288 > second = "-118125677427854462020143501606534917982669770757700043387.";
        EXPECT_EQ(first & second, "-110339679451121704481724470079515862731828647856523722803.");

        Aesi < 416 > third = "-74879503734724583837274125050082256621623554050652062268760606352177515366856.";
        Aesi < 288 > forth = "4464275899671659153811481946505732472685313017570285581072.";
        third &= forth; EXPECT_EQ(third, "-4022916809754901485440490100467899870640989758662608584960.");
    }
    {
        Aesi < 384 > first = "96276672247544313028184126350003821491591180041835675621297822318342179143124.";
        Aesi < 320 > second = "-2331796987614690954188238015926374024063789726729470521752.";
        EXPECT_EQ(first & second, "1988514923061861252996978413450367729642767110759789113744.");

        Aesi < 448 > third = "-25115953466959048608730398050794310170478098650770723615583944308380113724326.";
        Aesi < 256 > forth = "4073867819628966114550082046476785816185418797081467973406.";
        third &= forth; EXPECT_EQ(third, "-49052578586223602690389424410365517650694046036747510534.");
    }
    {
        Aesi < 416 > first = "5789711046003643371625812702497167362315689835104734122298893419945047957361.";
        Aesi < 192 > second = "-3464428060163340890515439424609412792916378453241656327447.";
        EXPECT_EQ(first & second, "25286192870510546249450053573609174837279947419660131601.");

        Aesi < 416 > third = "-76760021751027117829407530215789889573448236392359997436332047310762913504333.";
        Aesi < 288 > forth = "-3830319129684490175529452211068034947756070561201510512513.";
        third &= forth; EXPECT_EQ(third, "-3664195443549055657725435981887790074822402590824797185.");
    }
    {
        Aesi < 352 > first = "66172201904036700526713848286785598855249544535061337380424854198059455044033.";
        Aesi < 192 > second = "-4921123832430635255452260808929699445420271037896726974597.";
        EXPECT_EQ(first & second, "1586174059693448327548429964032361675105902795044549824641.");

        Aesi < 448 > third = "37222797790107559627047344626582537389590119155325681151298732702912220506224.";
        Aesi < 192 > forth = "-3072721876046445665452010231768230489571207699782240454198.";
        third &= forth; EXPECT_EQ(third, "882778253534421622415033413525665415212248939481121423408.");
    }
    {
        Aesi < 352 > first = "-101499263946954621926025869474050270367160146620289011967672455236138736269185.";
        Aesi < 224 > second = "2068363414486860101481221438815197642443386900537878609716.";
        EXPECT_EQ(first & second, "-393288847234706404925500911979564037195482481643975948032.");

        Aesi < 448 > third = "19789671140157935530422512023086262717333413605127911535384136547842929484176.";
        Aesi < 288 > forth = "204213153683526017580965211898914781532828000131466762970.";
        third &= forth; EXPECT_EQ(third, "383551576774829127002266402522732230735218139690696848.");
    }
    {
        Aesi < 416 > first = "36033088664716395164666829632668426995528527616231984518249135299245490747022.";
        Aesi < 224 > second = "-512445070158205515056046273867124718570766139429308191640.";
        EXPECT_EQ(first & second, "3453003781280681553594263995308565749734766513380692616.");

        Aesi < 416 > third = "106154794577112535930634099025913920648267910773172789904350793753369798461517.";
        Aesi < 320 > forth = "3758133084626239406320082985953440635800046079598414456045.";
        third &= forth; EXPECT_EQ(third, "3537397856444826687894233109523446693238406115289863438413.");
    }
    {
        Aesi < 416 > first = "-68660434717136150433166886871609102662531419246846874219677596658762930468606.";
        Aesi < 320 > second = "-2202404425567285315052512373947216183792432841504162792370.";
        EXPECT_EQ(first & second, "-424697438097361133285167934520620908609497872165497209522.");

        Aesi < 448 > third = "83717630034623670158946173045053787786765441255214038219775204244647061281856.";
        Aesi < 192 > forth = "4827688692558350435323998155882641576814171543070080119999.";
        third &= forth; EXPECT_EQ(third, "1673608481375159414424565064202407153580543737890087113728.");
    }
    {
        Aesi < 352 > first = "87089390724780776813131121773195706571278451625955341086322972437307953451284.";
        Aesi < 192 > second = "1069530734378560673953868426822431164195931341171270639084.";
        EXPECT_EQ(first & second, "37359069284231079140864473669079352437947499827781964036.");

        Aesi < 320 > third = "104969460739188799823877255664656439343641607917594117503105738173097010643497.";
        Aesi < 320 > forth = "-4338367399983010197286166012836530283440783904230913759189.";
        third &= forth; EXPECT_EQ(third, "1181183752757143641183464639426081015617789214468958339585.");
    }
    {
        Aesi < 448 > first = "75490924465571206915457216258531074118166670874351650793045321631612979756984.";
        Aesi < 320 > second = "1591687666104783793792758603763972004513869083433645214844.";
        EXPECT_EQ(first & second, "6139714442738671360905803039513296024973548070216502328.");

        Aesi < 320 > third = "-45118910226324835966965797516274421302205341821738945051946685591723858353224.";
        Aesi < 192 > forth = "-4529823143340174117859043586754598558383688291967801036379.";
        third &= forth; EXPECT_EQ(third, "-788951626562497105232946176752445670076415608615399066696.");
    }
    {
        Aesi < 416 > first = "-27707355879758217522842571717713059278408110584998416481317943900577009671975.";
        Aesi < 288 > second = "5253356959755269581532558820339778879947495962367164991581.";
        EXPECT_EQ(first & second, "-5104982477806357963631225409258768875283683506365355034629.");

        Aesi < 416 > third = "-65874483377331441743321660903193061110615260418304367117330197036676832896532.";
        Aesi < 192 > forth = "-1909222207259960248245653277533820868867225514266672256728.";
        third &= forth; EXPECT_EQ(third, "-1869752548762350774517239120297029219594880804876571379216.");
    }
    {
        Aesi < 352 > first = "55211295588562166413959046875763778374239473947246846133256433726169238345827.";
        Aesi < 224 > second = "-4528242700886012004098604446011202200089790685914072081739.";
        EXPECT_EQ(first & second, "396152812813136951968146082183843591656926905548550307907.");

        Aesi < 448 > third = "3081237158384780676865233056986186531836975543163659693672585781883002133315.";
        Aesi < 192 > forth = "-1557583863276090391864226942396892107519359460725791284816.";
        third &= forth; EXPECT_EQ(third, "1262934638831282027271836959488821526262935084915278092864.");
    }
    {
        Aesi < 448 > first = "87230983241131468262114743563753199627230365560140627278063059130596461261525.";
        Aesi < 288 > second = "6059266373722966892217373368395881121525432217434248566167.";
        EXPECT_EQ(first & second, "2110312308652405712612179766794608178441148630381333844117.");

        Aesi < 416 > third = "-55200902786437836100484611784964857287349908321789410306581440320304886575362.";
        Aesi < 224 > forth = "3994511592266628589108618082829858954583495766848434018745.";
        third &= forth; EXPECT_EQ(third, "-806142076864969233537497721419869690255346664157269922048.");
    }
    {
        Aesi < 416 > first = "-81751953531248694672106227909874904981473044126447633325576372303529417923087.";
        Aesi < 224 > second = "5300009780677188802458635130360659580116273785786623866968.";
        EXPECT_EQ(first & second, "-5100161625399158139400773231882611681259237309597911095304.");

        Aesi < 352 > third = "-110255999870415664120066103808003375005303461197788115024420314963594281576259.";
        Aesi < 256 > forth = "-1281376071911565902610331007994813307834152264211537692919.";
        third &= forth; EXPECT_EQ(third, "-790779678010960826580149752320404569099817778312523350083.");
    }
    {
        Aesi < 352 > first = "75240416277633848520383416748999163106923261850528535441562827013689460793351.";
        Aesi < 320 > second = "4066240883021209687463892161847847237736326564141594161953.";
        EXPECT_EQ(first & second, "3181894753315444530002527182113945211941137488818027896833.");

        Aesi < 416 > third = "76328788700576384388893631895951770259192432100039399699330482105576810537943.";
        Aesi < 256 > forth = "-883536891438642056374758468819179063487474794367972133623.";
        third &= forth; EXPECT_EQ(third, "785456404834202969542835029110694244187192261467363656407.");
    }
}