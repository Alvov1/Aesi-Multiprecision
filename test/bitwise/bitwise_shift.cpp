#include <gtest/gtest.h>
#include "../../Aesi.h"
#include "../benchmarks/benchmarks.h"

TEST(Bitwise, LeftShift) {
    const auto timeStart = std::chrono::system_clock::now();

    Aesi128 t = 14183932482008727;
    EXPECT_EQ(t << 48, "3992422065038923586049945894912");

    Aesi128 t2 = -51851516069619428;
    EXPECT_EQ(t2 << 40, "-57011344836360679021114032128");

    Aesi128 t3 = 664154091149463552;
    EXPECT_EQ(t3 << 32, "2852520100991549003783995392");
    EXPECT_EQ(t3 << 64, "12251480544941320143633640456854700032");

    Aesi512 m0 = "7611378567734697137.";
    EXPECT_EQ(m0 << 0, "7611378567734697137.");
    Aesi512 m1 = "-14850715800956435.";
    EXPECT_EQ(m1 << 1, "-29701431601912870.");
    Aesi512 m2 = "3028070178233437411.";
    EXPECT_EQ(m2 << 2, "12112280712933749644.");
    Aesi512 m3 = "9209955177909808159.";
    EXPECT_EQ(m3 << 3, "73679641423278465272.");
    Aesi512 m4 = "7165047339148406389.";
    EXPECT_EQ(m4 << 4, "114640757426374502224.");
    Aesi512 m5 = "-6626468019145325155.";
    EXPECT_EQ(m5 << 5, "-212046976612650404960.");
    Aesi512 m6 = "-7243061664548612285.";
    EXPECT_EQ(m6 << 6, "-463555946531111186240.");
    Aesi512 m7 = "-4116700124356305042.";
    EXPECT_EQ(m7 << 7, "-526937615917607045376.");
    Aesi512 m8 = "6549960156157611707.";
    EXPECT_EQ(m8 << 8, "1676789799976348596992.");
    Aesi512 m9 = "-2220785136167096747.";
    EXPECT_EQ(m9 << 9, "-1137041989717553534464.");
    Aesi512 m10 = "-7483545574330362604.";
    EXPECT_EQ(m10 << 10, "-7663150668114291306496.");
    Aesi512 m11 = "5261993495534712122.";
    EXPECT_EQ(m11 << 11, "10776562678855090425856.");
    Aesi512 m12 = "4481097010014354026.";
    EXPECT_EQ(m12 << 12, "18354573353018794090496.");
    Aesi512 m13 = "6106312505204834006.";
    EXPECT_EQ(m13 << 13, "50022912042638000177152.");
    Aesi512 m14 = "5040797595058699798.";
    EXPECT_EQ(m14 << 14, "82588427797441737490432.");
    Aesi512 m15 = "2583471234648375770.";
    EXPECT_EQ(m15 << 15, "84655185416957977231360.");
    Aesi512 m16 = "-6788631554508561346.";
    EXPECT_EQ(m16 << 16, "-444899757556273076371456.");
    Aesi512 m17 = "-4757003174447655866.";
    EXPECT_EQ(m17 << 17, "-623509920081203149668352.");
    Aesi512 m18 = "662716474672706556.";
    EXPECT_EQ(m18 << 18, "173727147536601987416064.");
    Aesi512 m19 = "5540167296155729817.";
    EXPECT_EQ(m19 << 19, "2904643231366895274295296.");
    Aesi512 m20 = "-4474265061727718627.";
    EXPECT_EQ(m20 << 20, "-4691606961366204287025152.");
    Aesi512 m21 = "5969471790508062653.";
    EXPECT_EQ(m21 << 21, "12518889704407564608864256.");
    Aesi512 m22 = "-5265695256006552653.";
    EXPECT_EQ(m22 << 22, "-22085926675049307818688512.");
    Aesi512 m23 = "6873645034989426292.";
    EXPECT_EQ(m23 << 23, "57660313729672581308481536.");
    Aesi512 m24 = "-7905873368535063591.";
    EXPECT_EQ(m24 << 24, "-132638545172560365439942656.");
    Aesi512 m25 = "-8693228561668035435.";
    EXPECT_EQ(m25 << 25, "-291696346632947901577297920.");
    Aesi512 m26 = "-7043023364600938157.";
    EXPECT_EQ(m26 << 26, "-472649297123826773050523648.");
    Aesi512 m27 = "9015025164445810640.";
    EXPECT_EQ(m27 << 27, "1209976195434743083219025920.");
    Aesi512 m28 = "9196295832952317037.";
    EXPECT_EQ(m28 << 28, "2468611865429455050083663872.");
    Aesi512 m29 = "8916222897565776331.";
    EXPECT_EQ(m29 << 29, "4786860718611420918811983872.");
    Aesi512 m30 = "-3572865449040353898.";
    EXPECT_EQ(m30 << 30, "-3836335064159168644044029952.");
    Aesi512 m31 = "-2302817096154652646.";
    EXPECT_EQ(m31 << 31, "-4945262058326960236404932608.");
    Aesi512 m32 = "8766205683538466197.";
    EXPECT_EQ(m32 << 32, "37650566720807037874116493312.");
    Aesi512 m33 = "1266493289020195681.";
    EXPECT_EQ(m33 << 33, "10879094513890432666830897152.");
    Aesi512 m34 = "-3803022461808819812.";
    EXPECT_EQ(m34 << 34, "-65335428397689160387587473408.");
    Aesi512 m35 = "2819148680530451735.";
    EXPECT_EQ(m35 << 35, "96865211083518737071451668480.");
    Aesi512 m36 = "-115014577408934116.";
    EXPECT_EQ(m36 << 36, "-7903741576554119143018725376.");
    Aesi512 m37 = "5094258238779213589.";
    EXPECT_EQ(m37 << 37, "700149521053929002539321131008.");
    Aesi512 m38 = "6926579382724352037.";
    EXPECT_EQ(m38 << 38, "1903963643004733400429182844928.");
    Aesi512 m39 = "-4288188454945410159.";
    EXPECT_EQ(m39 << 39, "-2357456534153639180571028488192.");
    Aesi512 m40 = "3988053960996393546.";
    EXPECT_EQ(m40 << 40, "4384911702313669082627960733696.");
    Aesi512 m41 = "-2258729486426273464.";
    EXPECT_EQ(m41 << 41, "-4966998668652400866832708272128.");
    Aesi512 m42 = "-3570856372627071555.";
    EXPECT_EQ(m42 << 42, "-15704792411285977019368310046720.");
    Aesi512 m43 = "-5982264275839351161.";
    EXPECT_EQ(m43 << 43, "-52620553053714710909654283583488.");
    Aesi512 m44 = "3885006050906365667.";
    EXPECT_EQ(m44 << 44, "68345749231226682154935199465472.");
    Aesi512 m45 = "2053736025208931047.";
    EXPECT_EQ(m45 << 45, "72259412483189886271357246767104.");
    Aesi512 m46 = "8299788207491102700.";
    EXPECT_EQ(m46 << 46, "584045673101733860269708070092800.");
    Aesi512 m47 = "-3983710329745327356.";
    EXPECT_EQ(m47 << 47, "-560657386143532875868869406752768.");
    Aesi512 m48 = "-983082642483429910.";
    EXPECT_EQ(m48 << 48, "-276713163897673592691636526120960.");
    Aesi512 m49 = "1193608687650818412.";
    EXPECT_EQ(m49 << 49, "671941955116301568858476242796544.");
    Aesi512 m50 = "-1409637001423648041.";
    EXPECT_EQ(m50 << 50, "-1587110168584801164226584152899584.");
    Aesi512 m51 = "-2318294309199358223.";
    EXPECT_EQ(m51 << 51, "-5220334693522685565061654122594304.");
    Aesi512 m52 = "7759206841436993107.";
    EXPECT_EQ(m52 << 52, "34944361039786245398611811287171072.");
    Aesi512 m53 = "2481279744575149350.";
    EXPECT_EQ(m53 << 53, "22349381066141204212750813967155200.");
    Aesi512 m54 = "6109086707179308773.";
    EXPECT_EQ(m54 << 54, "110051522472107141603454931416645632.");
    Aesi512 m55 = "-3627467853719473164.";
    EXPECT_EQ(m55 << 55, "-130693302994475777871668478058954752.");
    Aesi512 m56 = "5409416572247721086.";
    EXPECT_EQ(m56 << 56, "389789543345065958989778025495658496.");
    Aesi512 m57 = "-4523803313772409553.";
    EXPECT_EQ(m57 << 57, "-651948765382490837066286700183945216.");
    Aesi512 m58 = "353876324472099082.";
    EXPECT_EQ(m58 << 58, "101997906113778314260086863071019008.");
    Aesi512 m59 = "-6294738255972270889.";
    EXPECT_EQ(m59 << 59, "-3628669550590915205494791792421240832.");
    Aesi512 m60 = "4970526475298684237.";
    EXPECT_EQ(m60 << 60, "5730626862589526840406077674002317312.");
    Aesi512 m61 = "-5578860993609043904.";
    EXPECT_EQ(m61 << 61, "-12863977621488376418595430470787268608.");
    Aesi512 m62 = "-9076278761796422038.";
    EXPECT_EQ(m62 << 62, "-41856947865126003831195552773520228352.");
    Aesi512 m63 = "5117330721373399756.";
    EXPECT_EQ(m63 << 63, "47199045078853293325904793862141902848.");
    Aesi512 m64 = "-6514032524115553954.";
    EXPECT_EQ(m64 << 64, "-120162690860179866772223964920795889664.");

    Aesi < 448 > r0 = 6072323214095036032;
    EXPECT_EQ(r0 << 587, 6072323214095036032);
    Aesi < 640 > r1 = -8572474764272951220;
    EXPECT_EQ(r1 << 771, -8572474764272951220);
    Aesi < 320 > r2 = -9038684410537786378;
    EXPECT_EQ(r2 << 419, -9038684410537786378);
    Aesi < 640 > r3 = 1858310578097034903;
    EXPECT_EQ(r3 << 885, 1858310578097034903);
    Aesi < 320 > r4 = -1747591025141945043;
    EXPECT_EQ(r4 << 373, -1747591025141945043);
    Aesi < 576 > r5 = 6464175228791360326;
    EXPECT_EQ(r5 << 801, 6464175228791360326);
    Aesi < 448 > r6 = 8210083021775260927;
    EXPECT_EQ(r6 << 526, 8210083021775260927);
    Aesi < 352 > r7 = 9110354989523270182;
    EXPECT_EQ(r7 << 524, 9110354989523270182);
    Aesi < 512 > r8 = -5765383716230255672;
    EXPECT_EQ(r8 << 533, -5765383716230255672);
    Aesi < 448 > r9 = 5003573553825361921;
    EXPECT_EQ(r9 << 461, 5003573553825361921);

    Logging::addRecord("Bitwise-leftshift",
                       std::chrono::system_clock::to_time_t(timeStart),
                       (std::chrono::system_clock::now() - timeStart).count());;
}

TEST(Bitwise, RightShift) {
    const auto timeStart = std::chrono::system_clock::now();

    Aesi128 t = "3992422065038923586049945894912";
    EXPECT_EQ(t >> 48, 14183932482008727);

    Aesi128 t2 = "-57011344836360679021114032128";
    EXPECT_EQ(t2 >> 40, -51851516069619428);

    Aesi128 t3 = "12251480544941320143633640456854700032";
    EXPECT_EQ(t3 >> 32, "2852520100991549003783995392");
    EXPECT_EQ(t3 >> 64, 664154091149463552);

    Aesi512 m0 = "-7012752518397063856.";
    EXPECT_EQ(m0 >> 0, "-7012752518397063856.");
    Aesi512 m1 = "-509887270435692686.";
    EXPECT_EQ(m1 >> 1, "-254943635217846343.");
    Aesi512 m2 = "-8184334220959771790.";
    EXPECT_EQ(m2 >> 2, "-2046083555239942947.");
    Aesi512 m3 = "3351820170374867843.";
    EXPECT_EQ(m3 >> 3, "418977521296858480.");
    Aesi512 m4 = "4915421088540746270.";
    EXPECT_EQ(m4 >> 4, "307213818033796641.");
    Aesi512 m5 = "8438204166676859529.";
    EXPECT_EQ(m5 >> 5, "263693880208651860.");
    Aesi512 m6 = "-2739484334816504925.";
    EXPECT_EQ(m6 >> 6, "-42804442731507889.");
    Aesi512 m7 = "266001740642782779.";
    EXPECT_EQ(m7 >> 7, "2078138598771740.");
    Aesi512 m8 = "-1175290871526875389.";
    EXPECT_EQ(m8 >> 8, "-4590979966901856.");
    Aesi512 m9 = "815008955377970465.";
    EXPECT_EQ(m9 >> 9, "1591814365972598.");
    Aesi512 m10 = "2344488435310894562.";
    EXPECT_EQ(m10 >> 10, "2289539487608295.");
    Aesi512 m11 = "-3113852275729656862.";
    EXPECT_EQ(m11 >> 11, "-1520435681508621.");
    Aesi512 m12 = "434792608945898747.";
    EXPECT_EQ(m12 >> 12, "106150539293432.");
    Aesi512 m13 = "7322845047111508288.";
    EXPECT_EQ(m13 >> 13, "893901983289979.");
    Aesi512 m14 = "-1329128847375632490.";
    EXPECT_EQ(m14 >> 14, "-81123586875954.");
    Aesi512 m15 = "-1460969452823870895.";
    EXPECT_EQ(m15 >> 15, "-44585249414790.");
    Aesi512 m16 = "5088985740704164933.";
    EXPECT_EQ(m16 >> 16, "77651759959475.");
    Aesi512 m17 = "8654937513605207048.";
    EXPECT_EQ(m17 >> 17, "66031932934610.");
    Aesi512 m18 = "-7585990118536899168.";
    EXPECT_EQ(m18 >> 18, "-28938255762240.");
    Aesi512 m19 = "-9166759203599994615.";
    EXPECT_EQ(m19 >> 19, "-17484205634307.");
    Aesi512 m20 = "430195421370873728.";
    EXPECT_EQ(m20 >> 20, "410266324396.");
    Aesi512 m21 = "-6324517206293388887.";
    EXPECT_EQ(m21 >> 21, "-3015764811655.");
    Aesi512 m22 = "-552186186360978546.";
    EXPECT_EQ(m22 >> 22, "-131651445951.");
    Aesi512 m23 = "4291161933042871825.";
    EXPECT_EQ(m23 >> 23, "511546365385.");
    Aesi512 m24 = "5566105157328393012.";
    EXPECT_EQ(m24 >> 24, "331765720685.");
    Aesi512 m25 = "-447599232970243378.";
    EXPECT_EQ(m25 >> 25, "-13339496641.");
    Aesi512 m26 = "-6526777808899700007.";
    EXPECT_EQ(m26 >> 26, "-97256568206.");
    Aesi512 m27 = "5016099065664698267.";
    EXPECT_EQ(m27 >> 27, "37372850370.");
    Aesi512 m28 = "7433991250555581813.";
    EXPECT_EQ(m28 >> 28, "27693775484.");
    Aesi512 m29 = "-579349558847605025.";
    EXPECT_EQ(m29 >> 29, "-1079122645.");
    Aesi512 m30 = "8546705475788830920.";
    EXPECT_EQ(m30 >> 30, "7959739748.");
    Aesi512 m31 = "3973055550534862666.";
    EXPECT_EQ(m31 >> 31, "1850098162.");
    Aesi512 m32 = "-7102539187586558083.";
    EXPECT_EQ(m32 >> 32, "-1653688770.");
    Aesi512 m33 = "-1006163889429665095.";
    EXPECT_EQ(m33 >> 33, "-117132892.");
    Aesi512 m34 = "6052273411960370380.";
    EXPECT_EQ(m34 >> 34, "352288678.");
    Aesi512 m35 = "6032708312001015429.";
    EXPECT_EQ(m35 >> 35, "175574919.");
    Aesi512 m36 = "5302166584191945998.";
    EXPECT_EQ(m36 >> 36, "77156678.");
    Aesi512 m37 = "6702575940320330704.";
    EXPECT_EQ(m37 >> 37, "48767658.");
    Aesi512 m38 = "-2726192946820544501.";
    EXPECT_EQ(m38 >> 38, "-9917832.");
    Aesi512 m39 = "-1707356398469593785.";
    EXPECT_EQ(m39 >> 39, "-3105663.");
    Aesi512 m40 = "-1068135359883951539.";
    EXPECT_EQ(m40 >> 40, "-971463.");
    Aesi512 m41 = "-7896452788601812806.";
    EXPECT_EQ(m41 >> 41, "-3590890.");
    Aesi512 m42 = "1778047024676052239.";
    EXPECT_EQ(m42 >> 42, "404281.");
    Aesi512 m43 = "1228810500423788634.";
    EXPECT_EQ(m43 >> 43, "139699.");
    Aesi512 m44 = "4643629888420427605.";
    EXPECT_EQ(m44 >> 44, "263959.");
    Aesi512 m45 = "5768242547774764105.";
    EXPECT_EQ(m45 >> 45, "163943.");
    Aesi512 m46 = "2787779154174915047.";
    EXPECT_EQ(m46 >> 46, "39616.");
    Aesi512 m47 = "121923821763079398.";
    EXPECT_EQ(m47 >> 47, "866.");
    Aesi512 m48 = "5150859008093854496.";
    EXPECT_EQ(m48 >> 48, "18299.");
    Aesi512 m49 = "-2641967318352266365.";
    EXPECT_EQ(m49 >> 49, "-4693.");
    Aesi512 m50 = "-4236919705932143805.";
    EXPECT_EQ(m50 >> 50, "-3763.");
    Aesi512 m51 = "608702086868244174.";
    EXPECT_EQ(m51 >> 51, "270.");
    Aesi512 m52 = "557211125845202862.";
    EXPECT_EQ(m52 >> 52, "123.");
    Aesi512 m53 = "1898146143517035565.";
    EXPECT_EQ(m53 >> 53, "210.");
    Aesi512 m54 = "2849983067230014139.";
    EXPECT_EQ(m54 >> 54, "158.");
    Aesi512 m55 = "-7360929843008969715.";
    EXPECT_EQ(m55 >> 55, "-204.");
    Aesi512 m56 = "3333481632325305337.";
    EXPECT_EQ(m56 >> 56, "46.");
    Aesi512 m57 = "-7073367381067599246.";
    EXPECT_EQ(m57 >> 57, "-49.");
    Aesi512 m58 = "-5051357207431141036.";
    EXPECT_EQ(m58 >> 58, "-17.");
    Aesi512 m59 = "-2098067526904791870.";
    EXPECT_EQ(m59 >> 59, "-3.");
    Aesi512 m60 = "-7700403146794931890.";
    EXPECT_EQ(m60 >> 60, "-6.");
    Aesi512 m61 = "-640566444632702690.";
    EXPECT_EQ(m61 >> 61, "0.");
    Aesi512 m62 = "6071373372689047450.";
    EXPECT_EQ(m62 >> 62, "1.");
    Aesi512 m63 = "4993416047838457489.";
    EXPECT_EQ(m63 >> 63, "0.");
    Aesi512 m64 = "-3131877204238914397.";
    EXPECT_EQ(m64 >> 64, "0.");

    Aesi < 640 > r0 = -4123752496635792174;
    EXPECT_EQ(r0 >> 912, -4123752496635792174);
    Aesi < 384 > r1 = 2517497127064487752;
    EXPECT_EQ(r1 >> 408, 2517497127064487752);
    Aesi < 352 > r2 = 8495228711565174881;
    EXPECT_EQ(r2 >> 420, 8495228711565174881);
    Aesi < 640 > r3 = 7683298758282245769;
    EXPECT_EQ(r3 >> 695, 7683298758282245769);
    Aesi < 480 > r4 = -294229487585297021;
    EXPECT_EQ(r4 >> 622, -294229487585297021);
    Aesi < 480 > r5 = -4587985225776016414;
    EXPECT_EQ(r5 >> 664, -4587985225776016414);
    Aesi < 352 > r6 = 8028103029153636174;
    EXPECT_EQ(r6 >> 469, 8028103029153636174);
    Aesi < 448 > r7 = -5190368338978269751;
    EXPECT_EQ(r7 >> 581, -5190368338978269751);
    Aesi < 480 > r8 = 9183991195476062818;
    EXPECT_EQ(r8 >> 585, 9183991195476062818);
    Aesi < 320 > r9 = -5895904731635797704;
    EXPECT_EQ(r9 >> 434, -5895904731635797704);

    Logging::addRecord(testing::UnitTest::GetInstance()->current_test_info()->name(),
                       std::chrono::system_clock::to_time_t(timeStart),
                       (std::chrono::system_clock::now() - timeStart).count());;
}