#include <gtest/gtest.h>
#include "../../Multiprecision.h"

TEST(NumberTheory, PowerByModulo) {
    Multiprecision b0 = "340282366920938463463370103832140840975", p0 = "3221225475", m0 = "339950141050392709210118888586112663551";
    EXPECT_EQ(Multiprecision<512>::powm(b0, p0, m0), "242188462355016796506326460972064312371");
    Multiprecision b1 = "340282366920937254537843223041310457855", p1 = "4152412144", m1 = "340277169553477603280692196588073779168";
    EXPECT_EQ(Multiprecision<512>::powm(b1, p1, m1), "60029882824320387061860541177526572577");
    Multiprecision b2 = "340281717918493467709983746410956718080", p2 = "4262453711", m2 = "340282366918462583458590823176539734016";
    EXPECT_EQ(Multiprecision<512>::powm(b2, p2, m2), "166241065996741689193816594864568008704");
    Multiprecision b3 = "340282366920938463463374607431768211392", p3 = "4028567536", m3 = "340282366920938463462221685927161364480";
    EXPECT_EQ(Multiprecision<512>::powm(b3, p3, m3), "79348468858045354254941204451296280576");
    Multiprecision b4 = "340199290171201906239764863559915798527", p4 = "4294934535", m4 = "339619700034677138865667858647163596807";
    EXPECT_EQ(Multiprecision<512>::powm(b4, p4, m4), "190945401363700732035026529893014078999");
    Multiprecision b5 = "340261597733513957780485541721710524416", p5 = "4294934528", m5 = "338953159207418080134564096783067086848";
    EXPECT_EQ(Multiprecision<512>::powm(b5, p5, m5), "118087720759252501250044903309519060992");
    Multiprecision b6 = "340282366920628978453557757166577778695", p6 = "2160197376", m6 = "297747719934472147355449730221654212607";
    EXPECT_EQ(Multiprecision<512>::powm(b6, p6, m6), "57928875181475914237465337890967075425");
    Multiprecision b7 = "340282366287113163349539129860329308160", p7 = "4294443008", m7 = "340282204661661634250011215853758709760";
    EXPECT_EQ(Multiprecision<512>::powm(b7, p7, m7), "38813761968132398604603721199146762240");
    Multiprecision b8 = "340282366920938463463338578634749247488", p8 = "4278386880", m8 = "339622945219902160277232182215714013695";
    EXPECT_EQ(Multiprecision<512>::powm(b8, p8, m8), "333341121322987587452665281948710147831");
    Multiprecision b9 = "319180872486614983946280918507361140799", p9 = "4294967040", m9 = "340282366920938312347647155603121897471";
    EXPECT_EQ(Multiprecision<512>::powm(b9, p9, m9), "242605114336884705500497766875037306587");
    Multiprecision b10 = "340271982332173156289549102266793852927", p10 = "4163372931", m10 = "297747233310146261775346733316556440063";
    EXPECT_EQ(Multiprecision<512>::powm(b10, p10, m10), "239697327970302477233003760931426627547");
    Multiprecision b11 = "340282356782064470617754219073759084736", p11 = "4261513344", m11 = "340282366915986703306233086340761649151";
    EXPECT_EQ(Multiprecision<512>::powm(b11, p11, m11), "312000446828687383165588324067882112339");
    Multiprecision b12 = "340282366920938461102191365996945604608", p12 = "4164935711", m12 = "340282366919700523424098234356119635967";
    EXPECT_EQ(Multiprecision<512>::powm(b12, p12, m12), "97468202681093173268755220726194346809");
    Multiprecision b13 = "340282366920938463463374537063024033792", p13 = "3758096384", m13 = "340282042402385409462668642644496746495";
    EXPECT_EQ(Multiprecision<512>::powm(b13, p13, m13), "53290272390312948071804296107263189626");
    Multiprecision b14 = "340282366911034943149091565236870184959", p14 = "4288543756", m14 = "340282366920783720958468438497033190913";
    EXPECT_EQ(Multiprecision<512>::powm(b14, p14, m14), "31831287959824074494094319787582379094");
    Multiprecision b15 = "340282366920861092210919833985691418560", p15 = "4294836479", m15 = "170141183534745634093349748634288119808";
    EXPECT_EQ(Multiprecision<512>::powm(b15, p15, m15), "152943670371834072508570671925505343488");
    Multiprecision b16 = "340282366861507670171155465451549490688", p16 = "4232036448", m16 = "329651138469264312705628427181399998719";
    EXPECT_EQ(Multiprecision<512>::powm(b16, p16, m16), "166719213828605669472919223434275734462");
    Multiprecision b17 = "340282366920938463426481119284617543679", p17 = "4294837245", m17 = "339950217110666672240183291809579925759";
    EXPECT_EQ(Multiprecision<512>::powm(b17, p17, m17), "248339961938836228265170153500058810260");
    Multiprecision b18 = "340282361850336062587350489592374493183", p18 = "4269836273", m18 = "340282366920628978748701167538101551103";
    EXPECT_EQ(Multiprecision<512>::powm(b18, p18, m18), "247427145960671437473780361614290202142");
    Multiprecision b19 = "340282366920938444573908957428096958975", p19 = "4261543809", m19 = "340282366920938463463374607431767162880";
    EXPECT_EQ(Multiprecision<512>::powm(b19, p19, m19), "223637069157424417476278886297590759935");
    Multiprecision b20 = "340282366920938454018641641761180483584", p20 = "4262396157", m20 = "340116213421620090598440921119204573168";
    EXPECT_EQ(Multiprecision<512>::powm(b20, p20, m20), "231476390231591077951789595623433384336");
    Multiprecision b21 = "340282365653307206048250032802739781376", p21 = "4294836239", m21 = "340282366920919120650260790957158957025";
    EXPECT_EQ(Multiprecision<512>::powm(b21, p21, m21), "117644024555309964971288329605382960701");
    Multiprecision b22 = "340282366920861092210919306331779235840", p22 = "4026597383", m22 = "340282364385666277228892416139954479104";
    EXPECT_EQ(Multiprecision<512>::powm(b22, p22, m22), "10713627511155090396967609823168364544");
    Multiprecision b23 = "340282366920628978453625319888378658812", p23 = "4294901760", m23 = "340282290861902447996417243681684193248";
    EXPECT_EQ(Multiprecision<512>::powm(b23, p23, m23), "191350596849387162887012368283971124864");
    Multiprecision b24 = "340282366920938463315800654842091800575", p24 = "4026777600", m24 = "340240828546070184842346363461201559551";
    EXPECT_EQ(Multiprecision<512>::powm(b24, p24, m24), "23427068683975867853522421327192355067");
    Multiprecision b25 = "340282366920938462282782987264112721918", p25 = "4294959104", m25 = "340282356779772309484835218222462533632";
    EXPECT_EQ(Multiprecision<512>::powm(b25, p25, m25), "208678536903017550265612312104438595584");
    Multiprecision b26 = "340262895807699615046797828823085744128", p26 = "3766025990", m26 = "340282366920861092210921522895748332543";
    EXPECT_EQ(Multiprecision<512>::powm(b26, p26, m26), "64172493901475581739248659803490512734");
    Multiprecision b27 = "340282366920938463463374607431768211448", p27 = "4294959135", m27 = "340282366845461597767374466366359732224";
    EXPECT_EQ(Multiprecision<512>::powm(b27, p27, m27), "285260086283875379103218287969598177280");
    Multiprecision b28 = "334969998197550017945934343374934900751", p28 = "4293920767", m28 = "340116213422084318962010833539800497664";
    EXPECT_EQ(Multiprecision<512>::powm(b28, p28, m28), "233367085309087690416312817909571998447");
    Multiprecision b29 = "340277179694682324835520572089444597760", p29 = "4262460431", m29 = "340282285805536359603622681187362801663";
    EXPECT_EQ(Multiprecision<512>::powm(b29, p29, m29), "268233102554279753786580304454376085579");
}

TEST(NumberTheory, PowerByModuloDifferentPrecision) {

}