#include <gtest/gtest.h>
#include "../../Aesi.h"

TEST(Subtraction, Zero) {
    Aesi512 zero = 0;
    Aesi512 m0 = 14377898;
    EXPECT_EQ(m0 - 0, 14377898);
    EXPECT_EQ(0 - m0, -14377898);
    EXPECT_EQ(m0 + 0, 14377898);
    EXPECT_EQ(m0 + zero, 14377898);
    EXPECT_EQ(m0 - zero, 14377898);
    EXPECT_EQ(m0 + -zero, 14377898);
    EXPECT_EQ(m0 + +zero, 14377898);
    EXPECT_EQ(m0 - +zero, 14377898);
    EXPECT_EQ(m0 - -zero, 14377898);
    EXPECT_EQ(zero - m0, -14377898);
    EXPECT_EQ(+zero - m0, -14377898);
    EXPECT_EQ(-zero - m0, -14377898);
    m0 -= 0; EXPECT_EQ(m0, 14377898);
    m0 -= zero; EXPECT_EQ(m0, 14377898);
    m0 -= -zero; EXPECT_EQ(m0, 14377898);
    m0 -= +zero; EXPECT_EQ(m0, 14377898);

    Aesi512 m1 = 42824647;
    EXPECT_EQ(m1 - 0, 42824647);
    EXPECT_EQ(0 - m1, -42824647);
    EXPECT_EQ(m1 + 0, 42824647);
    EXPECT_EQ(m1 + zero, 42824647);
    EXPECT_EQ(m1 - zero, 42824647);
    EXPECT_EQ(m1 + -zero, 42824647);
    EXPECT_EQ(m1 + +zero, 42824647);
    EXPECT_EQ(m1 - +zero, 42824647);
    EXPECT_EQ(m1 - -zero, 42824647);
    EXPECT_EQ(zero - m1, -42824647);
    EXPECT_EQ(+zero - m1, -42824647);
    EXPECT_EQ(-zero - m1, -42824647);
    m1 -= 0; EXPECT_EQ(m1, 42824647);
    m1 -= zero; EXPECT_EQ(m1, 42824647);
    m1 -= -zero; EXPECT_EQ(m1, 42824647);
    m1 -= +zero; EXPECT_EQ(m1, 42824647);

    Aesi512 m2 = 56407773;
    EXPECT_EQ(m2 - 0, 56407773);
    EXPECT_EQ(0 - m2, -56407773);
    EXPECT_EQ(m2 + 0, 56407773);
    EXPECT_EQ(m2 + zero, 56407773);
    EXPECT_EQ(m2 - zero, 56407773);
    EXPECT_EQ(m2 + -zero, 56407773);
    EXPECT_EQ(m2 + +zero, 56407773);
    EXPECT_EQ(m2 - +zero, 56407773);
    EXPECT_EQ(m2 - -zero, 56407773);
    EXPECT_EQ(zero - m2, -56407773);
    EXPECT_EQ(+zero - m2, -56407773);
    EXPECT_EQ(-zero - m2, -56407773);
    m2 -= 0; EXPECT_EQ(m2, 56407773);
    m2 -= zero; EXPECT_EQ(m2, 56407773);
    m2 -= -zero; EXPECT_EQ(m2, 56407773);
    m2 -= +zero; EXPECT_EQ(m2, 56407773);
}

TEST(Subtraction, SmallPositive) {
    Aesi512 small1 = -8492, small2 = 4243, small3 = -678, small4 = 2323;
    EXPECT_EQ(small2 - small4, 1920);
    EXPECT_EQ(small3 - small1, 7814);
    EXPECT_EQ(small2 - small1, 12735);
    EXPECT_EQ(small2 - small3, 4921);
}

TEST(Subtraction, SmallNegative) {
    Aesi512 small1 = -8492, small2 = 4243, small3 = -678, small4 = 2323;
    EXPECT_EQ(small1 - small2, -12735);
    EXPECT_EQ(small3 - small2, -4921);
    EXPECT_EQ(small4 - small2, -1920);
    EXPECT_EQ(small1 - small3, -7814);
}

TEST(Subtraction, Decrement) {
    Aesi512 m0 = -33924914;
    --m0; m0--; m0--; --m0; m0--; m0--;
    EXPECT_EQ(m0, -33924920);
    Aesi512 t0 = m0--, u0 = --m0;
    EXPECT_EQ(t0, -33924920); EXPECT_EQ(u0, -33924922); EXPECT_EQ(m0, -33924922);

    Aesi512 m1 = 28310193;
    --m1; --m1; --m1; m1--; --m1; m1--; --m1; m1--; --m1; --m1; --m1;
    EXPECT_EQ(m1, 28310182);
    Aesi512 t1 = m1--, u1 = --m1;
    EXPECT_EQ(t1, 28310182); EXPECT_EQ(u1, 28310180); EXPECT_EQ(m1, 28310180);

    Aesi512 m2 = 57075809;
    --m2; m2--; m2--; m2--; m2--; --m2; --m2; --m2; --m2;
    EXPECT_EQ(m2, 57075800);
    Aesi512 t2 = m2--, u2 = --m2;
    EXPECT_EQ(t2, 57075800); EXPECT_EQ(u2, 57075798); EXPECT_EQ(m2, 57075798);

    Aesi512 m3 = -2900339;
    m3--; --m3; m3--; m3--; m3--; m3--; --m3; m3--; m3--; m3--; m3--; --m3; --m3; m3--;
    EXPECT_EQ(m3, -2900353);
    Aesi512 t3 = m3--, u3 = --m3;
    EXPECT_EQ(t3, -2900353); EXPECT_EQ(u3, -2900355); EXPECT_EQ(m3, -2900355);

    Aesi512 m4 = -12687358;
    --m4; --m4; --m4; --m4; --m4; m4--; m4--; --m4; --m4; m4--; m4--; m4--; m4--;
    EXPECT_EQ(m4, -12687371);
    Aesi512 t4 = m4--, u4 = --m4;
    EXPECT_EQ(t4, -12687371); EXPECT_EQ(u4, -12687373); EXPECT_EQ(m4, -12687373);
}

TEST(Subtraction, MixedSubtraction) {
    Aesi512 m0 = -78795448765594211, m1 = 48701305384651798;
    EXPECT_EQ(m0 - m1, -127496754150246009);
    Aesi512 m2 = 67574064564830699, m3 = -91803406528648461;
    EXPECT_EQ(m2 - m3, 159377471093479160);
    Aesi512 m4 = -96016808488224510, m5 = 250370865835895;
    EXPECT_EQ(m4 - m5, -96267179354060405);
    Aesi512 m6 = -41074518047002314, m7 = 95579003191734993;
    EXPECT_EQ(m6 - m7, -136653521238737307);
    Aesi512 m8 = -29705744161350641, m9 = 80392893348344206;
    EXPECT_EQ(m8 - m9, -110098637509694847);
    Aesi512 m10 = 46806496601606081, m11 = -91563580387805963;
    EXPECT_EQ(m10 - m11, 138370076989412044);
    Aesi512 m12 = -36224949170869920, m13 = 94125420376985567;
    EXPECT_EQ(m12 - m13, -130350369547855487);
    Aesi512 m14 = 56826716379651150, m15 = -3945619004625386;
    EXPECT_EQ(m14 - m15, 60772335384276536);
    Aesi512 m16 = 70075148666243867, m17 = 41028685512594215;
    EXPECT_EQ(m16 - m17, 29046463153649652);
    Aesi512 m18 = 9684075024490575, m19 = -94275562315467831;
    EXPECT_EQ(m18 - m19, 103959637339958406);
    Aesi512 m20 = -19394083460764198, m21 = 4598882134566940;
    EXPECT_EQ(m20 - m21, -23992965595331138);
    Aesi512 m22 = -59638329813822567, m23 = 39620622567810820;
    EXPECT_EQ(m22 - m23, -99258952381633387);
    Aesi512 m24 = 10481374612533748, m25 = -45690246001184389;
    EXPECT_EQ(m24 - m25, 56171620613718137);
    Aesi512 m26 = -39861901704867459, m27 = -71363004984618855;
    EXPECT_EQ(m26 - m27, 31501103279751396);
    Aesi512 m28 = 57092377547587484, m29 = 47047741340310546;
    EXPECT_EQ(m28 - m29, 10044636207276938);
    Aesi512 m30 = -60473701642492004, m31 = 36953318815595088;
    EXPECT_EQ(m30 - m31, -97427020458087092);
    Aesi512 m32 = -78684568025867499, m33 = 39474612379303263;
    EXPECT_EQ(m32 - m33, -118159180405170762);
    Aesi512 m34 = -59708830071153936, m35 = -24987753064694161;
    EXPECT_EQ(m34 - m35, -34721077006459775);
    Aesi512 m36 = -61431982293008665, m37 = -93223158394351966;
    EXPECT_EQ(m36 - m37, 31791176101343301);
    Aesi512 m38 = -77616429233373210, m39 = -56564296394666424;
    EXPECT_EQ(m38 - m39, -21052132838706786);
    Aesi512 m40 = -62011231426006983, m41 = -32675741172931378;
    EXPECT_EQ(m40 - m41, -29335490253075605);
    Aesi512 m42 = -36932046954643746, m43 = -6581413634276615;
    EXPECT_EQ(m42 - m43, -30350633320367131);
    Aesi512 m44 = -63308462008430376, m45 = -30568052971566789;
    EXPECT_EQ(m44 - m45, -32740409036863587);
    Aesi512 m46 = -3761885636924116, m47 = -51334343669010520;
    EXPECT_EQ(m46 - m47, 47572458032086404);
    Aesi512 m48 = 29643032223799847, m49 = -8815829513288304;
    EXPECT_EQ(m48 - m49, 38458861737088151);
    Aesi512 m50 = -63790459687888788, m51 = 56482071741526173;
    EXPECT_EQ(m50 - m51, -120272531429414961);
    Aesi512 m52 = 44052929832619500, m53 = 94503788809467804;
    EXPECT_EQ(m52 - m53, -50450858976848304);
    Aesi512 m54 = 75262871827916165, m55 = 75116929302625443;
    EXPECT_EQ(m54 - m55, 145942525290722);
    Aesi512 m56 = 42012563671870421, m57 = -39551471801647037;
    EXPECT_EQ(m56 - m57, 81564035473517458);
    Aesi512 m58 = -58094893884533034, m59 = -89603604140659081;
    EXPECT_EQ(m58 - m59, 31508710256126047);
    Aesi512 m60 = -15491398282947126, m61 = 75124171238430754;
    EXPECT_EQ(m60 - m61, -90615569521377880);
    Aesi512 m62 = -15279473212308778, m63 = -25214196246095585;
    EXPECT_EQ(m62 - m63, 9934723033786807);
    Aesi512 m64 = -15459700611573614, m65 = 61544035971577530;
    EXPECT_EQ(m64 - m65, -77003736583151144);
    Aesi512 m66 = -88407578525560434, m67 = 70572399006127154;
    EXPECT_EQ(m66 - m67, -158979977531687588);
    Aesi512 m68 = -76673284026197188, m69 = -42838723021411352;
    EXPECT_EQ(m68 - m69, -33834561004785836);
    Aesi512 m70 = -77534335981039599, m71 = -2575361264407743;
    EXPECT_EQ(m70 - m71, -74958974716631856);
    Aesi512 m72 = 14336673228002761, m73 = -63399735148346295;
    EXPECT_EQ(m72 - m73, 77736408376349056);
    Aesi512 m74 = -45220785989975054, m75 = -88657223135591669;
    EXPECT_EQ(m74 - m75, 43436437145616615);
    Aesi512 m76 = -3750032932034014, m77 = -3079274694736935;
    EXPECT_EQ(m76 - m77, -670758237297079);
    Aesi512 m78 = -57879783190606075, m79 = 30582080660739954;
    EXPECT_EQ(m78 - m79, -88461863851346029);
}

TEST(Subtraction, MixedSubtractionAssignment) {
    Aesi512 m0 = 76497282207537392, m1 = -81483767496064665;
    m0 -= m1; EXPECT_EQ(m0, 157981049703602057);
    Aesi512 m2 = 52766273087594876, m3 = -45464959271515713;
    m2 -= m3; EXPECT_EQ(m2, 98231232359110589);
    Aesi512 m4 = -39866035793358885, m5 = -74561994540740578;
    m4 -= m5; EXPECT_EQ(m4, 34695958747381693);
    Aesi512 m6 = -32310239597891199, m7 = 38858227484763400;
    m6 -= m7; EXPECT_EQ(m6, -71168467082654599);
    Aesi512 m8 = 83600373085209769, m9 = -4676747027315379;
    m8 -= m9; EXPECT_EQ(m8, 88277120112525148);
    Aesi512 m10 = 26800952209504502, m11 = -81901349566193950;
    m10 -= m11; EXPECT_EQ(m10, 108702301775698452);
    Aesi512 m12 = -22980648057789418, m13 = -62890011667727509;
    m12 -= m13; EXPECT_EQ(m12, 39909363609938091);
    Aesi512 m14 = -30243185699710800, m15 = 85196747975255772;
    m14 -= m15; EXPECT_EQ(m14, -115439933674966572);
    Aesi512 m16 = 88575636175295575, m17 = 5058788936387072;
    m16 -= m17; EXPECT_EQ(m16, 83516847238908503);
    Aesi512 m18 = -8627149227965893, m19 = -51145930004297782;
    m18 -= m19; EXPECT_EQ(m18, 42518780776331889);
    Aesi512 m20 = -61641748360877573, m21 = 1347982179977643;
    m20 -= m21; EXPECT_EQ(m20, -62989730540855216);
    Aesi512 m22 = -76812276267570764, m23 = -66388565315430388;
    m22 -= m23; EXPECT_EQ(m22, -10423710952140376);
    Aesi512 m24 = -22413217680403760, m25 = 20776822720647242;
    m24 -= m25; EXPECT_EQ(m24, -43190040401051002);
    Aesi512 m26 = 60501229183601977, m27 = -97208132801489513;
    m26 -= m27; EXPECT_EQ(m26, 157709361985091490);
    Aesi512 m28 = -90717506923312883, m29 = 80581288039243653;
    m28 -= m29; EXPECT_EQ(m28, -171298794962556536);
    Aesi512 m30 = -1434671774297789, m31 = -48788207733204515;
    m30 -= m31; EXPECT_EQ(m30, 47353535958906726);
    Aesi512 m32 = 98636409838290088, m33 = -24858988765114797;
    m32 -= m33; EXPECT_EQ(m32, 123495398603404885);
    Aesi512 m34 = 32698890626094304, m35 = -95452487538418616;
    m34 -= m35; EXPECT_EQ(m34, 128151378164512920);
    Aesi512 m36 = 54592571715348901, m37 = 27499032134617746;
    m36 -= m37; EXPECT_EQ(m36, 27093539580731155);
    Aesi512 m38 = -34229390668287600, m39 = 70527679356389759;
    m38 -= m39; EXPECT_EQ(m38, -104757070024677359);
    Aesi512 m40 = 38082671719287318, m41 = 90080041129782021;
    m40 -= m41; EXPECT_EQ(m40, -51997369410494703);
    Aesi512 m42 = -26471635935191754, m43 = -11535551530392665;
    m42 -= m43; EXPECT_EQ(m42, -14936084404799089);
    Aesi512 m44 = 45091999474176387, m45 = -33228319472241331;
    m44 -= m45; EXPECT_EQ(m44, 78320318946417718);
    Aesi512 m46 = -91842884207028021, m47 = 51904091210877915;
    m46 -= m47; EXPECT_EQ(m46, -143746975417905936);
    Aesi512 m48 = -5357775061339009, m49 = -25273398031638359;
    m48 -= m49; EXPECT_EQ(m48, 19915622970299350);
    Aesi512 m50 = -14905275244784635, m51 = -94021456037974671;
    m50 -= m51; EXPECT_EQ(m50, 79116180793190036);
    Aesi512 m52 = -13576279815222827, m53 = -42123086873941691;
    m52 -= m53; EXPECT_EQ(m52, 28546807058718864);
    Aesi512 m54 = -52554401815218966, m55 = 99184114388707534;
    m54 -= m55; EXPECT_EQ(m54, -151738516203926500);
    Aesi512 m56 = -3883942059250462, m57 = -34609928360199472;
    m56 -= m57; EXPECT_EQ(m56, 30725986300949010);
    Aesi512 m58 = 14175824081074887, m59 = 1435953275620283;
    m58 -= m59; EXPECT_EQ(m58, 12739870805454604);
    Aesi512 m60 = -60149276957042841, m61 = -76721648621066592;
    m60 -= m61; EXPECT_EQ(m60, 16572371664023751);
    Aesi512 m62 = 61326832747483284, m63 = 46379655301271614;
    m62 -= m63; EXPECT_EQ(m62, 14947177446211670);
    Aesi512 m64 = 21854645686000102, m65 = 45002361665513639;
    m64 -= m65; EXPECT_EQ(m64, -23147715979513537);
    Aesi512 m66 = 33091273075346782, m67 = 321895524121470;
    m66 -= m67; EXPECT_EQ(m66, 32769377551225312);
    Aesi512 m68 = -51174023236882378, m69 = 66903075876437798;
    m68 -= m69; EXPECT_EQ(m68, -118077099113320176);
    Aesi512 m70 = -24801419283802435, m71 = -14207322058971261;
    m70 -= m71; EXPECT_EQ(m70, -10594097224831174);
    Aesi512 m72 = -92599999116779629, m73 = 90215441005269707;
    m72 -= m73; EXPECT_EQ(m72, -182815440122049336);
    Aesi512 m74 = 73877826268355011, m75 = 65420173307826179;
    m74 -= m75; EXPECT_EQ(m74, 8457652960528832);
    Aesi512 m76 = 19586642362468978, m77 = -65885160582015983;
    m76 -= m77; EXPECT_EQ(m76, 85471802944484961);
    Aesi512 m78 = 7573797785526040, m79 = -17722295466379071;
    m78 -= m79; EXPECT_EQ(m78, 25296093251905111);

}

TEST(Subtraction, DifferentPrecision) {
    {
        Aesi < 448 > first = 62809965279956307; // Aesi<14 blocks>
        Aesi < 448 > second = 39080556778759957; // Aesi<14 blocks>
        EXPECT_EQ(first - second, 23729408501196350);

        Aesi < 192 > third = 45398660613732434; // Aesi<6 blocks>
        Aesi < 352 > forth = -53004642661804844; // Aesi<11 blocks>
        forth -= third; EXPECT_EQ(forth, -98403303275537278);
    }
    {
        Aesi < 320 > first = 18374689440060232; // Aesi<10 blocks>
        Aesi < 288 > second = -53557241983505081; // Aesi<9 blocks>
        EXPECT_EQ(first - second, 71931931423565313);

        Aesi < 256 > third = 71440960238152095; // Aesi<8 blocks>
        Aesi < 448 > forth = 27627026332533578; // Aesi<14 blocks>
        forth -= third; EXPECT_EQ(forth, -43813933905618517);
    }
    {
        Aesi < 320 > first = -58860382348449740; // Aesi<10 blocks>
        Aesi < 448 > second = -51106271527231455; // Aesi<14 blocks>
        EXPECT_EQ(first - second, -7754110821218285);

        Aesi < 320 > third = -26435995134335414; // Aesi<10 blocks>
        Aesi < 416 > forth = 6966067345525782; // Aesi<13 blocks>
        forth -= third; EXPECT_EQ(forth, 33402062479861196);
    }
    {
        Aesi < 224 > first = 26949994938035307; // Aesi<7 blocks>
        Aesi < 320 > second = -57345460147331841; // Aesi<10 blocks>
        EXPECT_EQ(first - second, 84295455085367148);

        Aesi < 320 > third = 40115210446714256; // Aesi<10 blocks>
        Aesi < 416 > forth = 19929757054766530; // Aesi<13 blocks>
        forth -= third; EXPECT_EQ(forth, -20185453391947726);
    }
    {
        Aesi < 480 > first = 43936342115046018; // Aesi<15 blocks>
        Aesi < 480 > second = -10279600786446307; // Aesi<15 blocks>
        EXPECT_EQ(first - second, 54215942901492325);

        Aesi < 256 > third = -22316375566079840; // Aesi<8 blocks>
        Aesi < 480 > forth = 76005949847059604; // Aesi<15 blocks>
        forth -= third; EXPECT_EQ(forth, 98322325413139444);
    }
    {
        Aesi < 192 > first = -93657206214492841; // Aesi<6 blocks>
        Aesi < 256 > second = -71486982985505092; // Aesi<8 blocks>
        EXPECT_EQ(first - second, -22170223228987749);

        Aesi < 320 > third = -66846726585288343; // Aesi<10 blocks>
        Aesi < 416 > forth = 94957726168621779; // Aesi<13 blocks>
        forth -= third; EXPECT_EQ(forth, 161804452753910122);
    }
    {
        Aesi < 192 > first = -62005162619173997; // Aesi<6 blocks>
        Aesi < 224 > second = 10671564912426240; // Aesi<7 blocks>
        EXPECT_EQ(first - second, -72676727531600237);

        Aesi < 224 > third = -30028516325007256; // Aesi<7 blocks>
        Aesi < 416 > forth = -38572290747742216; // Aesi<13 blocks>
        forth -= third; EXPECT_EQ(forth, -8543774422734960);
    }
    {
        Aesi < 320 > first = -58940891305080103; // Aesi<10 blocks>
        Aesi < 320 > second = -57959309993606272; // Aesi<10 blocks>
        EXPECT_EQ(first - second, -981581311473831);

        Aesi < 224 > third = 30782639550732749; // Aesi<7 blocks>
        Aesi < 416 > forth = -14578762817130093; // Aesi<13 blocks>
        forth -= third; EXPECT_EQ(forth, -45361402367862842);
    }
    {
        Aesi < 480 > first = 51699864098074373; // Aesi<15 blocks>
        Aesi < 448 > second = -48065639687773956; // Aesi<14 blocks>
        EXPECT_EQ(first - second, 99765503785848329);

        Aesi < 320 > third = 10097273671316052; // Aesi<10 blocks>
        Aesi < 384 > forth = 90189328318453908; // Aesi<12 blocks>
        forth -= third; EXPECT_EQ(forth, 80092054647137856);
    }
    {
        Aesi < 416 > first = -10287965013816677; // Aesi<13 blocks>
        Aesi < 448 > second = -86849365490800050; // Aesi<14 blocks>
        EXPECT_EQ(first - second, 76561400476983373);

        Aesi < 288 > third = -92327403515448960; // Aesi<9 blocks>
        Aesi < 480 > forth = -33125917700155649; // Aesi<15 blocks>
        forth -= third; EXPECT_EQ(forth, 59201485815293311);
    }
}

TEST(Subtraction, Huge) {
    Aesi512 m0 = "33222596524985513709662952543563830144665033768843521976647267647208461019340.", m1 = "38164587188950119838788779223640089081210824113434762269236295652677101782847.";
    EXPECT_EQ(m0 - m1, "-4941990663964606129125826680076258936545790344591240292589028005468640763507.");
    Aesi512 m2 = "-20655758169036112271685620846052214614763131315690731014041641003605056720634.", m3 = "59199224584144892366883614712316743122019635122733897184093806569587153761359.";
    EXPECT_EQ(m2 - m3, "-79854982753181004638569235558368957736782766438424628198135447573192210481993.");
    Aesi512 m4 = "26958868127252037114576940803541315851501818694925913710169209014144090575221.", m5 = "-56690160172817430971857821372203806609205243229668824848471807171498249879318.";
    EXPECT_EQ(m4 - m5, "83649028300069468086434762175745122460707061924594738558641016185642340454539.");
    Aesi512 m6 = "62271417650077980871661978474505797628609067899109204694570720181432917537155.", m7 = "37893123994206120771871620930908678086437541807476235392480822787464692298836.";
    EXPECT_EQ(m6 - m7, "24378293655871860099790357543597119542171526091632969302089897393968225238319.");
    Aesi512 m8 = "29119125820549207989533872126988773973336509273086275931307116309627663872764.", m9 = "103422645015979300874351532976096329446015089824804268157728527112508361966955.";
    EXPECT_EQ(m8 - m9, "-74303519195430092884817660849107555472678580551717992226421410802880698094191.");
    Aesi512 m10 = "50685555657005502622459560104926025111811051971013153345984376288752108540188.", m11 = "11843150404386388672920897470954408372302381204169961052664707905647933686837.";
    EXPECT_EQ(m10 - m11, "38842405252619113949538662633971616739508670766843192293319668383104174853351.");
    Aesi512 m12 = "-30900015346017600139138533552783308255981128442348425033319973544038485573472.", m13 = "-77992754162449513537054313689747133344104862431700888956875859760399783240435.";
    EXPECT_EQ(m12 - m13, "47092738816431913397915780136963825088123733989352463923555886216361297666963.");
    Aesi512 m14 = "65082877906485644797721502363270835120492034138725085010689320321661912760737.", m15 = "-38969237421470469438500362894082110662786709839661076629850200418243852223388.";
    EXPECT_EQ(m14 - m15, "104052115327956114236221865257352945783278743978386161640539520739905764984125.");
    Aesi512 m16 = "61212903975196419295571316677874168511942655895870466644870726328349386664897.", m17 = "92619071253884935168968518756355928446184177736323740507835354552468063275534.";
    EXPECT_EQ(m16 - m17, "-31406167278688515873397202078481759934241521840453273862964628224118676610637.");
    Aesi512 m18 = "-109423328323685337223243585746549977936151472435030868767338269334030245780476.", m19 = "106980979290762696136437657186082334204905776714683848866090958404411158872201.";
    EXPECT_EQ(m18 - m19, "-216404307614448033359681242932632312141057249149714717633429227738441404652677.");
    Aesi512 m20 = "63552600707916277817720537500363942441908285110796788213427780401436510185750.", m21 = "48949257653219171838097393706614389785635520588763819977555147498680754785689.";
    EXPECT_EQ(m20 - m21, "14603343054697105979623143793749552656272764522032968235872632902755755400061.");
    Aesi512 m22 = "80954485105355033282884478790513874455581515000409570871000175336925361642696.", m23 = "-15491903030310570779840793986611440289534185668407172861515710596746544596406.";
    EXPECT_EQ(m22 - m23, "96446388135665604062725272777125314745115700668816743732515885933671906239102.");
    Aesi512 m24 = "-100691731824186068764968826464574719708400095616997195584756451515329304133617.", m25 = "-100046691375446418738112774473177013367893295657206102959213724682429093090171.";
    EXPECT_EQ(m24 - m25, "-645040448739650026856051991397706340506799959791092625542726832900211043446.");
    Aesi512 m26 = "69907242277614666400287666286616049218777988280380023239870563976484469658330.", m27 = "-5078726041238874192253951761215504716450449736385389877662725507693927853612.";
    EXPECT_EQ(m26 - m27, "74985968318853540592541618047831553935228438016765413117533289484178397511942.");
    Aesi512 m28 = "-72064544621693023707170549905448391811193918132072455068924098586410745176963.", m29 = "-112788947572031669352390148660909930700043267816392846193686326130634540416853.";
    EXPECT_EQ(m28 - m29, "40724402950338645645219598755461538888849349684320391124762227544223795239890.");
    Aesi512 m30 = "-40882820628165474745984965016509801758293621338996271988397807746014654142440.", m31 = "99198140551075478590383016971471611901720362790536512975762861418717025064819.";
    EXPECT_EQ(m30 - m31, "-140080961179240953336367981987981413660013984129532784964160669164731679207259.");
    Aesi512 m32 = "-109111989092615602121419552227361347083553546992868639722304979612312773895105.", m33 = "55010922565031645146809449116768001661722824418643628244820717827722058872985.";
    EXPECT_EQ(m32 - m33, "-164122911657647247268229001344129348745276371411512267967125697440034832768090.");
    Aesi512 m34 = "19898073490294501319621680853914831631426239624483851397515427093512533545708.", m35 = "-90310803675666748770044729156579955271304420605016556659379137084668790990990.";
    EXPECT_EQ(m34 - m35, "110208877165961250089666410010494786902730660229500408056894564178181324536698.");
    Aesi512 m36 = "88138684465567652012578510190024346729952426116694926616788015677014776782038.", m37 = "-110466946002425997027566594215278641859585678157602102095618335328528575825477.";
    EXPECT_EQ(m36 - m37, "198605630467993649040145104405302988589538104274297028712406351005543352607515.");
    Aesi512 m38 = "71577173473491035814151216394314316595642112940484353409863250980259338066239.", m39 = "92108652034337674738354989171228951131762735929308425410841512173070831672258.";
    EXPECT_EQ(m38 - m39, "-20531478560846638924203772776914634536120622988824072000978261192811493606019.");
    Aesi512 m40 = "-63440691425172217479898559816235529686305091157362335875809085576110842892885.", m41 = "-63795520363725445401562797099751089065569801197474521515790205559435009961491.";
    EXPECT_EQ(m40 - m41, "354828938553227921664237283515559379264710040112185639981119983324167068606.");
    Aesi512 m42 = "-115517095520320949983186900947191662095928727331133077531986466168009664912659.", m43 = "3352973153240526402924981556162601221294988986607230953214012744254070043780.";
    EXPECT_EQ(m42 - m43, "-118870068673561476386111882503354263317223716317740308485200478912263734956439.");
    Aesi512 m44 = "2610559525592840142842762222198043612825996352965818891304756511547357142734.", m45 = "-6913485315335810525181676495765444329548153996277518112500092852513311852208.";
    EXPECT_EQ(m44 - m45, "9524044840928650668024438717963487942374150349243337003804849364060668994942.");
    Aesi512 m46 = "-97500706297397923462646489702631558452903335381260841190219325763941162928018.", m47 = "-48123377138634807747887134902683167588223745154696969320323977098955092175384.";
    EXPECT_EQ(m46 - m47, "-49377329158763115714759354799948390864679590226563871869895348664986070752634.");
    Aesi512 m48 = "56566630587882601367005167971293714803349239427453170990236600295437467804981.", m49 = "-14081756289437455587948835268927184363729806121020471512803317601227492241866.";
    EXPECT_EQ(m48 - m49, "70648386877320056954954003240220899167079045548473642503039917896664960046847.");
    Aesi512 m50 = "91618056312627750469926223893568929342270887199062050930564853327442406953224.", m51 = "-51278692377129304162219307711464762510159987983897482063537371187421125065709.";
    EXPECT_EQ(m50 - m51, "142896748689757054632145531605033691852430875182959532994102224514863532018933.");
    Aesi512 m52 = "-46964633813664458685977109998658517280889777396567992359752624956120962922996.", m53 = "90483707431967222703100777943282422615209102912420617113405312520509476610175.";
    EXPECT_EQ(m52 - m53, "-137448341245631681389077887941940939896098880308988609473157937476630439533171.");
    Aesi512 m54 = "38371228225280602355561278455922897623434967881107610292980950563105223837019.", m55 = "51683884607355301333473325338787671840047111115965832452345954636683990449438.";
    EXPECT_EQ(m54 - m55, "-13312656382074698977912046882864774216612143234858222159365004073578766612419.");
    Aesi512 m56 = "-74988399562281635378306461552451389784621304264353654752806865918711343715010.", m57 = "-51368118090333402494971347143142457785617585182764002742063450153089155471016.";
    EXPECT_EQ(m56 - m57, "-23620281471948232883335114409308931999003719081589652010743415765622188243994.");
    Aesi512 m58 = "-57783930614347594204895765322618734671756211340787021508887237149528342051331.", m59 = "38252465199386292022020899509508093778744442175770614003544480075636467549885.";
    EXPECT_EQ(m58 - m59, "-96036395813733886226916664832126828450500653516557635512431717225164809601216.");
    Aesi512 m60 = "-105037808863071143136280567390912600661668417381384029445606346583600447575944.", m61 = "-10100265705668152253869959230893731182489495739946840904675099276961328919038.";
    EXPECT_EQ(m60 - m61, "-94937543157402990882410608160018869479178921641437188540931247306639118656906.");
    Aesi512 m62 = "-77342544119066042052356221357567298013829096789933634129435013375234756068107.", m63 = "57982276766897717870621647321953113025674790001544682187764646062150591427706.";
    EXPECT_EQ(m62 - m63, "-135324820885963759922977868679520411039503886791478316317199659437385347495813.");
    Aesi512 m64 = "82109627665560004436006227203118823278537980902639624995656993122237864704661.", m65 = "-37476366201541662693700238424140425499396005834257551217865668727677027299764.";
    EXPECT_EQ(m64 - m65, "119585993867101667129706465627259248777933986736897176213522661849914892004425.");
    Aesi512 m66 = "94746145757664330736331789598219169709676747254675537796541093495564575547629.", m67 = "-80295723245701713883941051502993562885914257770957092316351549290528802228953.";
    EXPECT_EQ(m66 - m67, "175041869003366044620272841101212732595591005025632630112892642786093377776582.");
    Aesi512 m68 = "-62205219590368656517373653537566334278125361061944704007095355398852388685777.", m69 = "-69759521213814445854358269773975450616308875639642050020152001773009074525222.";
    EXPECT_EQ(m68 - m69, "7554301623445789336984616236409116338183514577697346013056646374156685839445.");
    Aesi512 m70 = "-52018008406009027204400038295771181434823032854961801629435980574369930405617.", m71 = "48258637967364684888731426454671140030000400847227823814582874801529824079683.";
    EXPECT_EQ(m70 - m71, "-100276646373373712093131464750442321464823433702189625444018855375899754485300.");
    Aesi512 m72 = "-62332885183385243844058787080310280067520965771691909531189028120991339869389.", m73 = "6348735979717991983972369426504079154461583860760946738495267090664006456532.";
    EXPECT_EQ(m72 - m73, "-68681621163103235828031156506814359221982549632452856269684295211655346325921.");
    Aesi512 m74 = "52071012593060623602408189450573668951427299770652626616894658222191313153941.", m75 = "-57699409424083664658784369543357837130473765455970762985223614494324479962207.";
    EXPECT_EQ(m74 - m75, "109770422017144288261192558993931506081901065226623389602118272716515793116148.");
    Aesi512 m76 = "-13425517474516487808633030437360462889284209510408099377905980719718376754044.", m77 = "93176027713798714455781005592937632137607759249583290215549115952808316378365.";
    EXPECT_EQ(m76 - m77, "-106601545188315202264414036030298095026891968759991389593455096672526693132409.");
    Aesi512 m78 = "-34000990628541689650586425967236449811962489573399592518797616588764678311522.", m79 = "112735151533921799285028979146314326415142765594527880905828573317748052289962.";
    EXPECT_EQ(m78 - m79, "-146736142162463488935615405113550776227105255167927473424626189906512730601484.");
}

TEST(Subtraction, HugeAssignment) {
    Aesi512 m0 = "5021555443161350435343743466255338443131530915074558960926318256228994680600.", m1 = "-85719994781587882332412559153868900916066423953219741217892093915831882842556.";
    m0 -= m1; EXPECT_EQ(m0, "90741550224749232767756302620124239359197954868294300178818412172060877523156.");
    Aesi512 m2 = "100174169972639146960615775553170901369115376387076814088869992592912560747942.", m3 = "-107282235675435932023120015659323681095907719806543822097032890721520985982185.";
    m2 -= m3; EXPECT_EQ(m2, "207456405648075078983735791212494582465023096193620636185902883314433546730127.");
    Aesi512 m4 = "78170546042698907611504653697393424536359162898692773353321953155209900336276.", m5 = "33391044965348871365767888030959759172966142607881492709732146581928527463824.";
    m4 -= m5; EXPECT_EQ(m4, "44779501077350036245736765666433665363393020290811280643589806573281372872452.");
    Aesi512 m6 = "-76772143453561056040336653671233185724352013908042045937046372435857610514469.", m7 = "106538021746428492311940413586930292977538122001651765863508273971115125034854.";
    m6 -= m7; EXPECT_EQ(m6, "-183310165199989548352277067258163478701890135909693811800554646406972735549323.");
    Aesi512 m8 = "-72909603898537174930313271244616509170259578923036163595525269688866859747391.", m9 = "-7161285656105994165115509152016523761505204352824209448800869579914110209376.";
    m8 -= m9; EXPECT_EQ(m8, "-65748318242431180765197762092599985408754374570211954146724400108952749538015.");
    Aesi512 m10 = "-62074166724638544455462042777391615251163788981404737367134026707641286643377.", m11 = "51891915800062421620211998790809812694505190596100009103570331826417400308306.";
    m10 -= m11; EXPECT_EQ(m10, "-113966082524700966075674041568201427945668979577504746470704358534058686951683.");
    Aesi512 m12 = "-78838559842638677581481243364460864462920735575476913773490453140857869228067.", m13 = "72054345108634957913094627915215443033478417265748089236055132491429623674536.";
    m12 -= m13; EXPECT_EQ(m12, "-150892904951273635494575871279676307496399152841225003009545585632287492902603.");
    Aesi512 m14 = "13120017110616461521468402741923338436805343638174725979449023759617349909327.", m15 = "86370881378439920118427473446906964233064368723456931476794828628913591082063.";
    m14 -= m15; EXPECT_EQ(m14, "-73250864267823458596959070704983625796259025085282205497345804869296241172736.");
    Aesi512 m16 = "-16366068998741025550681011261248680804279944015243250885351640763747667151899.", m17 = "87344149565387928799748768897997250540172474987632300948155020153403583110709.";
    m16 -= m17; EXPECT_EQ(m16, "-103710218564128954350429780159245931344452419002875551833506660917151250262608.");
    Aesi512 m18 = "-58084358663068189820812032067498711418847237464830769448383290180213063238795.", m19 = "-100908642605357358870811382857458300720257976353711833968167959110953704075383.";
    m18 -= m19; EXPECT_EQ(m18, "42824283942289169049999350789959589301410738888881064519784668930740640836588.");
    Aesi512 m20 = "-32296842873527547016394011159127688649248769704473660817110653309011429809011.", m21 = "58741619996974314605642126958257743442074701487008508282213403393893875209795.";
    m20 -= m21; EXPECT_EQ(m20, "-91038462870501861622036138117385432091323471191482169099324056702905305018806.");
    Aesi512 m22 = "69952890721640886203345873414192222462131750911900292126704810227750463299569.", m23 = "77765114689911367868124690868160095110439973660097708139491179259149672441509.";
    m22 -= m23; EXPECT_EQ(m22, "-7812223968270481664778817453967872648308222748197416012786369031399209141940.");
    Aesi512 m24 = "-57434957991165694932357631911927294084164742710665673700680380621655356115258.", m25 = "-99242518361371508596912840723392881501561210574474351911315699982046737543148.";
    m24 -= m25; EXPECT_EQ(m24, "41807560370205813664555208811465587417396467863808678210635319360391381427890.");
    Aesi512 m26 = "98300901471094315699137535710731778426103127590682675692706430144952233318738.", m27 = "50665380962851170484179954762230592410525206707887496708187096121745418857880.";
    m26 -= m27; EXPECT_EQ(m26, "47635520508243145214957580948501186015577920882795178984519334023206814460858.");
    Aesi512 m28 = "-37262100675873190464709698573910438869431367036756776170790211319724914252595.", m29 = "88105005638323380203447508117966163572906597468717203121967776454306733825534.";
    m28 -= m29; EXPECT_EQ(m28, "-125367106314196570668157206691876602442337964505473979292757987774031648078129.");
    Aesi512 m30 = "-29160040964356647095935341485209761437320701128473337125858639317988878745620.", m31 = "40760471294051373574794477932449977872859372440492853896959611986643098090155.";
    m30 -= m31; EXPECT_EQ(m30, "-69920512258408020670729819417659739310180073568966191022818251304631976835775.");
    Aesi512 m32 = "115260870051118666139680610682460318662883697012724246593045751444401739915425.", m33 = "68648461719212012941966995282240730938272126367987370046704949536973842216035.";
    m32 -= m33; EXPECT_EQ(m32, "46612408331906653197713615400219587724611570644736876546340801907427897699390.");
    Aesi512 m34 = "-20472243798489170668021409476885179297791906929515162423853828877842849481713.", m35 = "24265084003520114121360496014746041034674747980825690699673158176731210307066.";
    m34 -= m35; EXPECT_EQ(m34, "-44737327802009284789381905491631220332466654910340853123526987054574059788779.");
    Aesi512 m36 = "41543475181796934565690901519770293897106009882112351387455297776944705820170.", m37 = "-93585670921380344371068727435006167375534726206829832897147712963754914621889.";
    m36 -= m37; EXPECT_EQ(m36, "135129146103177278936759628954776461272640736088942184284603010740699620442059.");
    Aesi512 m38 = "-98506985554776878159552161904228269867232216231420463309051809269530856201685.", m39 = "-112691126129771387457033382401927262496027568447660174954910910095983161964222.";
    m38 -= m39; EXPECT_EQ(m38, "14184140574994509297481220497698992628795352216239711645859100826452305762537.");
    Aesi512 m40 = "-83573290255470326837494352855586503055523612683267269144532423399236956037170.", m41 = "-93293665856845919222690230815308558714558784150496407686250481213781443775807.";
    m40 -= m41; EXPECT_EQ(m40, "9720375601375592385195877959722055659035171467229138541718057814544487738637.");
    Aesi512 m42 = "115736705052455902015170052380765113841591402561081435865534805962808903803577.", m43 = "-69362873228450408138138038011840889227959890201724211999236878273327744368401.";
    m42 -= m43; EXPECT_EQ(m42, "185099578280906310153308090392606003069551292762805647864771684236136648171978.");
    Aesi512 m44 = "-92041150441778688018380433000712930295741784470520060861235898363172151503236.", m45 = "26640931763196499571358520008314012344119967661893355372393447072665104846697.";
    m44 -= m45; EXPECT_EQ(m44, "-118682082204975187589738953009026942639861752132413416233629345435837256349933.");
    Aesi512 m46 = "83164599375251949336647029143904637187736455547770279849122073052477836658486.", m47 = "100829938528882531123194721142045871042353459839907687665404611540318550811032.";
    m46 -= m47; EXPECT_EQ(m46, "-17665339153630581786547691998141233854617004292137407816282538487840714152546.");
    Aesi512 m48 = "64397034661334920608981229356154434766390562210766362157947938037470391337555.", m49 = "-99452608157324203948530089340727010008283153265111618280108930853928742194952.";
    m48 -= m49; EXPECT_EQ(m48, "163849642818659124557511318696881444774673715475877980438056868891399133532507.");
    Aesi512 m50 = "-101802292697160746098320302085320082731653198392002449628120797527487021322973.", m51 = "113238395804062725428280415833707973379877830791046802294629188978325240854014.";
    m50 -= m51; EXPECT_EQ(m50, "-215040688501223471526600717919028056111531029183049251922749986505812262176987.");
    Aesi512 m52 = "-62354430202370183310097428643792474961347670458820451941873413306672299557963.", m53 = "13883937916034789931044202285429614805677985953799268972582788138900734285183.";
    m52 -= m53; EXPECT_EQ(m52, "-76238368118404973241141630929222089767025656412619720914456201445573033843146.");
    Aesi512 m54 = "-4706728942432637809323697163341267476111674518715021316049976737971200076606.", m55 = "-10289531615886953666206020808850415873890361732224059583394996004236684695977.";
    m54 -= m55; EXPECT_EQ(m54, "5582802673454315856882323645509148397778687213509038267345019266265484619371.");
    Aesi512 m56 = "71675571155438292917540158677559422953350594240337761843913406150616377346080.", m57 = "78329763029119095884303716556478766957353928555860692953380824487016867457001.";
    m56 -= m57; EXPECT_EQ(m56, "-6654191873680802966763557878919344004003334315522931109467418336400490110921.");
    Aesi512 m58 = "-65789803601350742614767579169501919344154678175719851395735904600018437215262.", m59 = "99675718461673344653333232346196148081073494030400220651697711351816092305699.";
    m58 -= m59; EXPECT_EQ(m58, "-165465522063024087268100811515698067425228172206120072047433615951834529520961.");
    Aesi512 m60 = "17823391170127178430703079062051812880373802357725835159096763661843952555084.", m61 = "68347209285830506654335804472177585730343417137924985149090773639759172343152.";
    m60 -= m61; EXPECT_EQ(m60, "-50523818115703328223632725410125772849969614780199149989994009977915219788068.");
    Aesi512 m62 = "-50106258275167560080663580607352658701756970754448143607737617004311348794021.", m63 = "106755461937546681456481021878035738686412999223470518436782266676807562479530.";
    m62 -= m63; EXPECT_EQ(m62, "-156861720212714241537144602485388397388169969977918662044519883681118911273551.");
    Aesi512 m64 = "-26094572908207019398426614685466857901876990662475050234875246097344379677949.", m65 = "-29469109930553188358351949965388705192776244994087476080671425638841184498138.";
    m64 -= m65; EXPECT_EQ(m64, "3374537022346168959925335279921847290899254331612425845796179541496804820189.");
    Aesi512 m66 = "-102671191736207284417171960689609739505759033564715946371473625373278619812273.", m67 = "18574825673741365049190432931203328581864336132838842380751688345498734335593.";
    m66 -= m67; EXPECT_EQ(m66, "-121246017409948649466362393620813068087623369697554788752225313718777354147866.");
    Aesi512 m68 = "-28588934748771361054703458891108520546571710103309879891123257760282836351820.", m69 = "38317614963296817761991032641682468042338090966753032824119892661065560584182.";
    m68 -= m69; EXPECT_EQ(m68, "-66906549712068178816694491532790988588909801070062912715243150421348396936002.");
    Aesi512 m70 = "104751260809620197087710213227699839954718704706094715829189659308239442081389.", m71 = "-30577062896415400829896865979726946733195826494809281546945483678475139287379.";
    m70 -= m71; EXPECT_EQ(m70, "135328323706035597917607079207426786687914531200903997376135142986714581368768.");
    Aesi512 m72 = "-64754456137351490197496525693211096774427006972150534587761930850411620759755.", m73 = "-103604251144844696762839812014277871829301458338671135722787422614354301684212.";
    m72 -= m73; EXPECT_EQ(m72, "38849795007493206565343286321066775054874451366520601135025491763942680924457.");
    Aesi512 m74 = "96645170846776034136605091215289554998380547861502778082978677827325308912576.", m75 = "-94116540293770744347128118072873539610557537023032970587815042390811862439404.";
    m74 -= m75; EXPECT_EQ(m74, "190761711140546778483733209288163094608938084884535748670793720218137171351980.");
    Aesi512 m76 = "-98410801330254651903836359454252629145536768157058994755130545667289501962590.", m77 = "30938974986841686767445921277148681991908188507875838430222173971702496279766.";
    m76 -= m77; EXPECT_EQ(m76, "-129349776317096338671282280731401311137444956664934833185352719638991998242356.");
    Aesi512 m78 = "-59101614662735099695616215039060178192442022297580333710825038350486946014934.", m79 = "-49928955047523282066604479622960500311543004097546657058268120760593434751728.";
    m78 -= m79; EXPECT_EQ(m78, "-9172659615211817629011735416099677880899018200033676652556917589893511263206.");
}