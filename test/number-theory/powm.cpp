#include <gtest/gtest.h>
#include "../../Multiprecision.h"

TEST(NumberTheory, PowerByModulo) {
    Multiprecision b0 = "340282366920938463463370103832140840975", p0 = "3221225475", m0 = "339950141050392709210118888586112663551";
    EXPECT_EQ(Multiprecision<512>::powm(b0, p0, m0), "242188462355016796506326460972064312371");
    Multiprecision b1 = "340282366920937254537843223041310457855", p1 = "4152412144", m1 = "340277169553477603280692196588073779168";
    EXPECT_EQ(Multiprecision<512>::powm(b1, p1, m1), "60029882824320387061860541177526572577");
    Multiprecision b2 = "340281717918493467709983746410956718080", p2 = "4262453711", m2 = "340282366918462583458590823176539734016";
    EXPECT_EQ(Multiprecision<512>::powm(b2, p2, m2), "166241065996741689193816594864568008704");
    Multiprecision b3 = "340282366920938463463374607431768211392", p3 = "4028567536", m3 = "340282366920938463462221685927161364480";
    EXPECT_EQ(Multiprecision<512>::powm(b3, p3, m3), "79348468858045354254941204451296280576");
    Multiprecision b4 = "340199290171201906239764863559915798527", p4 = "4294934535", m4 = "339619700034677138865667858647163596807";
    EXPECT_EQ(Multiprecision<512>::powm(b4, p4, m4), "190945401363700732035026529893014078999");
    Multiprecision b5 = "340261597733513957780485541721710524416", p5 = "4294934528", m5 = "338953159207418080134564096783067086848";
    EXPECT_EQ(Multiprecision<512>::powm(b5, p5, m5), "118087720759252501250044903309519060992");
    Multiprecision b6 = "340282366920628978453557757166577778695", p6 = "2160197376", m6 = "297747719934472147355449730221654212607";
    EXPECT_EQ(Multiprecision<512>::powm(b6, p6, m6), "57928875181475914237465337890967075425");
    Multiprecision b7 = "340282366287113163349539129860329308160", p7 = "4294443008", m7 = "340282204661661634250011215853758709760";
    EXPECT_EQ(Multiprecision<512>::powm(b7, p7, m7), "38813761968132398604603721199146762240");
    Multiprecision b8 = "340282366920938463463338578634749247488", p8 = "4278386880", m8 = "339622945219902160277232182215714013695";
    EXPECT_EQ(Multiprecision<512>::powm(b8, p8, m8), "333341121322987587452665281948710147831");
    Multiprecision b9 = "319180872486614983946280918507361140799", p9 = "4294967040", m9 = "340282366920938312347647155603121897471";
    EXPECT_EQ(Multiprecision<512>::powm(b9, p9, m9), "242605114336884705500497766875037306587");
    Multiprecision b10 = "340271982332173156289549102266793852927", p10 = "4163372931", m10 = "297747233310146261775346733316556440063";
    EXPECT_EQ(Multiprecision<512>::powm(b10, p10, m10), "239697327970302477233003760931426627547");
    Multiprecision b11 = "340282356782064470617754219073759084736", p11 = "4261513344", m11 = "340282366915986703306233086340761649151";
    EXPECT_EQ(Multiprecision<512>::powm(b11, p11, m11), "312000446828687383165588324067882112339");
    Multiprecision b12 = "340282366920938461102191365996945604608", p12 = "4164935711", m12 = "340282366919700523424098234356119635967";
    EXPECT_EQ(Multiprecision<512>::powm(b12, p12, m12), "97468202681093173268755220726194346809");
    Multiprecision b13 = "340282366920938463463374537063024033792", p13 = "3758096384", m13 = "340282042402385409462668642644496746495";
    EXPECT_EQ(Multiprecision<512>::powm(b13, p13, m13), "53290272390312948071804296107263189626");
    Multiprecision b14 = "340282366911034943149091565236870184959", p14 = "4288543756", m14 = "340282366920783720958468438497033190913";
    EXPECT_EQ(Multiprecision<512>::powm(b14, p14, m14), "31831287959824074494094319787582379094");
    Multiprecision b15 = "340282366920861092210919833985691418560", p15 = "4294836479", m15 = "170141183534745634093349748634288119808";
    EXPECT_EQ(Multiprecision<512>::powm(b15, p15, m15), "152943670371834072508570671925505343488");
    Multiprecision b16 = "340282366861507670171155465451549490688", p16 = "4232036448", m16 = "329651138469264312705628427181399998719";
    EXPECT_EQ(Multiprecision<512>::powm(b16, p16, m16), "166719213828605669472919223434275734462");
    Multiprecision b17 = "340282366920938463426481119284617543679", p17 = "4294837245", m17 = "339950217110666672240183291809579925759";
    EXPECT_EQ(Multiprecision<512>::powm(b17, p17, m17), "248339961938836228265170153500058810260");
    Multiprecision b18 = "340282361850336062587350489592374493183", p18 = "4269836273", m18 = "340282366920628978748701167538101551103";
    EXPECT_EQ(Multiprecision<512>::powm(b18, p18, m18), "247427145960671437473780361614290202142");
    Multiprecision b19 = "340282366920938444573908957428096958975", p19 = "4261543809", m19 = "340282366920938463463374607431767162880";
    EXPECT_EQ(Multiprecision<512>::powm(b19, p19, m19), "223637069157424417476278886297590759935");
    Multiprecision b20 = "340282366920938454018641641761180483584", p20 = "4262396157", m20 = "340116213421620090598440921119204573168";
    EXPECT_EQ(Multiprecision<512>::powm(b20, p20, m20), "231476390231591077951789595623433384336");
    Multiprecision b21 = "340282365653307206048250032802739781376", p21 = "4294836239", m21 = "340282366920919120650260790957158957025";
    EXPECT_EQ(Multiprecision<512>::powm(b21, p21, m21), "117644024555309964971288329605382960701");
    Multiprecision b22 = "340282366920861092210919306331779235840", p22 = "4026597383", m22 = "340282364385666277228892416139954479104";
    EXPECT_EQ(Multiprecision<512>::powm(b22, p22, m22), "10713627511155090396967609823168364544");
    Multiprecision b23 = "340282366920628978453625319888378658812", p23 = "4294901760", m23 = "340282290861902447996417243681684193248";
    EXPECT_EQ(Multiprecision<512>::powm(b23, p23, m23), "191350596849387162887012368283971124864");
    Multiprecision b24 = "340282366920938463315800654842091800575", p24 = "4026777600", m24 = "340240828546070184842346363461201559551";
    EXPECT_EQ(Multiprecision<512>::powm(b24, p24, m24), "23427068683975867853522421327192355067");
    Multiprecision b25 = "340282366920938462282782987264112721918", p25 = "4294959104", m25 = "340282356779772309484835218222462533632";
    EXPECT_EQ(Multiprecision<512>::powm(b25, p25, m25), "208678536903017550265612312104438595584");
    Multiprecision b26 = "340262895807699615046797828823085744128", p26 = "3766025990", m26 = "340282366920861092210921522895748332543";
    EXPECT_EQ(Multiprecision<512>::powm(b26, p26, m26), "64172493901475581739248659803490512734");
    Multiprecision b27 = "340282366920938463463374607431768211448", p27 = "4294959135", m27 = "340282366845461597767374466366359732224";
    EXPECT_EQ(Multiprecision<512>::powm(b27, p27, m27), "285260086283875379103218287969598177280");
    Multiprecision b28 = "334969998197550017945934343374934900751", p28 = "4293920767", m28 = "340116213422084318962010833539800497664";
    EXPECT_EQ(Multiprecision<512>::powm(b28, p28, m28), "233367085309087690416312817909571998447");
    Multiprecision b29 = "340277179694682324835520572089444597760", p29 = "4262460431", m29 = "340282285805536359603622681187362801663";
    EXPECT_EQ(Multiprecision<512>::powm(b29, p29, m29), "268233102554279753786580304454376085579");
    Multiprecision b30 = "340282366920938463463370103832140840975", p30 = "3221225475", m30 = "339950141050392709210118888586112663551";
    EXPECT_EQ(Multiprecision<512>::powm(b30, p30, m30), "242188462355016796506326460972064312371");
    Multiprecision b31 = "340282366920937254537843223041310457855", p31 = "4152412144", m31 = "340277169553477603280692196588073779168";
    EXPECT_EQ(Multiprecision<512>::powm(b31, p31, m31), "60029882824320387061860541177526572577");
    Multiprecision b32 = "340281717918493467709983746410956718080", p32 = "4262453711", m32 = "340282366918462583458590823176539734016";
    EXPECT_EQ(Multiprecision<512>::powm(b32, p32, m32), "166241065996741689193816594864568008704");
    Multiprecision b33 = "340282366920938463463374607431768211392", p33 = "4028567536", m33 = "340282366920938463462221685927161364480";
    EXPECT_EQ(Multiprecision<512>::powm(b33, p33, m33), "79348468858045354254941204451296280576");
    Multiprecision b34 = "340199290171201906239764863559915798527", p34 = "4294934535", m34 = "339619700034677138865667858647163596807";
    EXPECT_EQ(Multiprecision<512>::powm(b34, p34, m34), "190945401363700732035026529893014078999");
    Multiprecision b35 = "340261597733513957780485541721710524416", p35 = "4294934528", m35 = "338953159207418080134564096783067086848";
    EXPECT_EQ(Multiprecision<512>::powm(b35, p35, m35), "118087720759252501250044903309519060992");
    Multiprecision b36 = "340282366920628978453557757166577778695", p36 = "2160197376", m36 = "297747719934472147355449730221654212607";
    EXPECT_EQ(Multiprecision<512>::powm(b36, p36, m36), "57928875181475914237465337890967075425");
    Multiprecision b37 = "340282366287113163349539129860329308160", p37 = "4294443008", m37 = "340282204661661634250011215853758709760";
    EXPECT_EQ(Multiprecision<512>::powm(b37, p37, m37), "38813761968132398604603721199146762240");
    Multiprecision b38 = "340282366920938463463338578634749247488", p38 = "4278386880", m38 = "339622945219902160277232182215714013695";
    EXPECT_EQ(Multiprecision<512>::powm(b38, p38, m38), "333341121322987587452665281948710147831");
    Multiprecision b39 = "319180872486614983946280918507361140799", p39 = "4294967040", m39 = "340282366920938312347647155603121897471";
    EXPECT_EQ(Multiprecision<512>::powm(b39, p39, m39), "242605114336884705500497766875037306587");
    Multiprecision b40 = "340271982332173156289549102266793852927", p40 = "4163372931", m40 = "297747233310146261775346733316556440063";
    EXPECT_EQ(Multiprecision<512>::powm(b40, p40, m40), "239697327970302477233003760931426627547");
    Multiprecision b41 = "340282356782064470617754219073759084736", p41 = "4261513344", m41 = "340282366915986703306233086340761649151";
    EXPECT_EQ(Multiprecision<512>::powm(b41, p41, m41), "312000446828687383165588324067882112339");
    Multiprecision b42 = "340282366920938461102191365996945604608", p42 = "4164935711", m42 = "340282366919700523424098234356119635967";
    EXPECT_EQ(Multiprecision<512>::powm(b42, p42, m42), "97468202681093173268755220726194346809");
    Multiprecision b43 = "340282366920938463463374537063024033792", p43 = "3758096384", m43 = "340282042402385409462668642644496746495";
    EXPECT_EQ(Multiprecision<512>::powm(b43, p43, m43), "53290272390312948071804296107263189626");
    Multiprecision b44 = "340282366911034943149091565236870184959", p44 = "4288543756", m44 = "340282366920783720958468438497033190913";
    EXPECT_EQ(Multiprecision<512>::powm(b44, p44, m44), "31831287959824074494094319787582379094");
    Multiprecision b45 = "340282366920861092210919833985691418560", p45 = "4294836479", m45 = "170141183534745634093349748634288119808";
    EXPECT_EQ(Multiprecision<512>::powm(b45, p45, m45), "152943670371834072508570671925505343488");
    Multiprecision b46 = "340282366861507670171155465451549490688", p46 = "4232036448", m46 = "329651138469264312705628427181399998719";
    EXPECT_EQ(Multiprecision<512>::powm(b46, p46, m46), "166719213828605669472919223434275734462");
    Multiprecision b47 = "340282366920938463426481119284617543679", p47 = "4294837245", m47 = "339950217110666672240183291809579925759";
    EXPECT_EQ(Multiprecision<512>::powm(b47, p47, m47), "248339961938836228265170153500058810260");
    Multiprecision b48 = "340282361850336062587350489592374493183", p48 = "4269836273", m48 = "340282366920628978748701167538101551103";
    EXPECT_EQ(Multiprecision<512>::powm(b48, p48, m48), "247427145960671437473780361614290202142");
    Multiprecision b49 = "340282366920938444573908957428096958975", p49 = "4261543809", m49 = "340282366920938463463374607431767162880";
    EXPECT_EQ(Multiprecision<512>::powm(b49, p49, m49), "223637069157424417476278886297590759935");
    Multiprecision b50 = "340282366920938454018641641761180483584", p50 = "4262396157", m50 = "340116213421620090598440921119204573168";
    EXPECT_EQ(Multiprecision<512>::powm(b50, p50, m50), "231476390231591077951789595623433384336");
    Multiprecision b51 = "340282365653307206048250032802739781376", p51 = "4294836239", m51 = "340282366920919120650260790957158957025";
    EXPECT_EQ(Multiprecision<512>::powm(b51, p51, m51), "117644024555309964971288329605382960701");
    Multiprecision b52 = "340282366920861092210919306331779235840", p52 = "4026597383", m52 = "340282364385666277228892416139954479104";
    EXPECT_EQ(Multiprecision<512>::powm(b52, p52, m52), "10713627511155090396967609823168364544");
    Multiprecision b53 = "340282366920628978453625319888378658812", p53 = "4294901760", m53 = "340282290861902447996417243681684193248";
    EXPECT_EQ(Multiprecision<512>::powm(b53, p53, m53), "191350596849387162887012368283971124864");
    Multiprecision b54 = "340282366920938463315800654842091800575", p54 = "4026777600", m54 = "340240828546070184842346363461201559551";
    EXPECT_EQ(Multiprecision<512>::powm(b54, p54, m54), "23427068683975867853522421327192355067");
    Multiprecision b55 = "340282366920938462282782987264112721918", p55 = "4294959104", m55 = "340282356779772309484835218222462533632";
    EXPECT_EQ(Multiprecision<512>::powm(b55, p55, m55), "208678536903017550265612312104438595584");
    Multiprecision b56 = "340262895807699615046797828823085744128", p56 = "3766025990", m56 = "340282366920861092210921522895748332543";
    EXPECT_EQ(Multiprecision<512>::powm(b56, p56, m56), "64172493901475581739248659803490512734");
    Multiprecision b57 = "340282366920938463463374607431768211448", p57 = "4294959135", m57 = "340282366845461597767374466366359732224";
    EXPECT_EQ(Multiprecision<512>::powm(b57, p57, m57), "285260086283875379103218287969598177280");
    Multiprecision b58 = "334969998197550017945934343374934900751", p58 = "4293920767", m58 = "340116213422084318962010833539800497664";
    EXPECT_EQ(Multiprecision<512>::powm(b58, p58, m58), "233367085309087690416312817909571998447");
    Multiprecision b59 = "340277179694682324835520572089444597760", p59 = "4262460431", m59 = "340282285805536359603622681187362801663";
    EXPECT_EQ(Multiprecision<512>::powm(b59, p59, m59), "268233102554279753786580304454376085579");
    Multiprecision b60 = "340282366911044614555648447090190709759", p60 = "2614075360", m60 = "324331628436373015035827870745021612095";
    EXPECT_EQ(Multiprecision<512>::powm(b60, p60, m60), "321308343561923855798635763926656739221");
    Multiprecision b61 = "340282361850336064911640234083693363199", p61 = "4292870144", m61 = "340277174624080533098656447199962996727";
    EXPECT_EQ(Multiprecision<512>::powm(b61, p61, m61), "99163972616564212548124075484381357561");
    Multiprecision b62 = "340282364385637848580359689036369888255", p62 = "3228630529", m62 = "340282366920928792056835704796880044016";
    EXPECT_EQ(Multiprecision<512>::powm(b62, p62, m62), "224895594760573080057101367770110602559");
    Multiprecision b63 = "340282366920938463463374607431231340544", p63 = "4160750079", m63 = "170146375757326859862645280231119650815";
    EXPECT_EQ(Multiprecision<512>::powm(b63, p63, m63), "24910572981143788971613813233771388604");
    Multiprecision b64 = "340282366762520824024180112230859931648", p64 = "4294967040", m64 = "340282366920899777837146939298179579904";
    EXPECT_EQ(Multiprecision<512>::powm(b64, p64, m64), "296788396968999906848410558214205472768");
    Multiprecision b65 = "340282366841710300949110269838224261120", p65 = "4278190080", m65 = "340282366915986703306233086336464584704";
    EXPECT_EQ(Multiprecision<512>::powm(b65, p65, m65), "258644231797530889913750262848776306688");
    Multiprecision b66 = "340271982327221696038428535782461411327", p66 = "4294852607", m66 = "340282365663191232442635938000672923616";
    EXPECT_EQ(Multiprecision<512>::powm(b66, p66, m66), "242248090282170461766659024475051275519");
    Multiprecision b67 = "340281089129132833667595137259881398271", p67 = "4039145486", m67 = "340282366918462583412474525941481078784";
    EXPECT_EQ(Multiprecision<512>::powm(b67, p67, m67), "251734169798359909736989918535001636865");
    Multiprecision b68 = "340282366920628978453553271159136452607", p68 = "4291034111", m68 = "170805797438554951271019019305710780415";
    EXPECT_EQ(Multiprecision<512>::powm(b68, p68, m68), "80753144702431381130139248546548724923");
    Multiprecision b69 = "340282366920938463463374607429620727808", p69 = "4292869127", m69 = "337623910929368782242998636980171964415";
    EXPECT_EQ(Multiprecision<512>::powm(b69, p69, m69), "218677222025751705255625011738538361297");
}

TEST(NumberTheory, PowerByModuloDifferentPrecision) {

}