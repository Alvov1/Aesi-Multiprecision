#include <gtest/gtest.h>
#include "../../../Aeu.h"

TEST(Unsigned_Modulo, Basic) {
    Aeu128 one = 1u, zero = 0u, ten = 10u, two = 2u;
    EXPECT_EQ(zero % one, zero);
    EXPECT_EQ(ten % two, 0u);
    EXPECT_EQ(two % ten, 2u);
    EXPECT_EQ(ten % one, 0u);
    EXPECT_EQ(one % ten, 1u);
}

TEST(Unsigned_Modulo, Huge) {
    {
        Aeu512 l = "1783226737224736337522964318179999023462659013680417186304521084051448770463651068950508494580637178936626484511014232321636328902899469917237903746.",
                r = "8268678513111315215.";
        EXPECT_EQ(l % r, "3906061104977397816."); //62 bits
    }
    {
        Aeu512 l = "2379478249816019221457816217327105235718733467830970056695397927129821212786751040528317158577913310334070400043599904761503829196310658908505775935.",
                r = "13706438806614895674.";
        EXPECT_EQ(l % r, "9770876234940830165."); //64 bits
    }
    {
        Aeu512 l = "300724623809101040940383112804122830962158261602298149540159388558128096506536939660912454793080101484029443187515228272564321704400935080223987431.",
                r = "342608469526777231.";
        EXPECT_EQ(l % r, "341289225210333625."); //59 bits
    }
    {
        Aeu512 l = "1269419280363575462007292990668101772170188158406681708452197400140864858703644186668143109759746076204245599854301643467665267877307076393436289042.",
                r = "5164849778431907218.";
        EXPECT_EQ(l % r, "1525980964097290504."); //61 bits
    }
    {
        Aeu512 l = "1275584947594624288208924139671052384145289159692676228354113520959636528672867794449779283758357303704059491110681662677012914378711997751489869805.",
                r = "5167093773460492867.";
        EXPECT_EQ(l % r, "3451724433698381338."); //62 bits
    }
    {
        Aeu512 l = "302775621523881514940046645781857935257585384042730869977584815533534909126128257451493842382799865612027569173082001206738369347239255156089712923.",
                r = "3680012006140506110.";
        EXPECT_EQ(l % r, "1180335576425459613."); //61 bits
    }
    {
        Aeu512 l = "2871915327457485782706437049495359179609693444454421830411425170135550229741507653035029686954473373768796511278566822769810353701782956537214752716.",
                r = "6345843092661678404.";
        EXPECT_EQ(l % r, "580691458645278348."); //60 bits
    }
    {
        Aeu512 l = "1228739214080512999036083854316508480518024971601394870040572816070396251526010768500590922395544534640086938391993979197769927582466325821056973167.",
                r = "8718088907182610343.";
        EXPECT_EQ(l % r, "2790076391207771529."); //62 bits
    }
    {
        Aeu512 l = "2461219523511565418557676769009807565004434267860992454805072000211541248402029297567400611696258034638951470123007524792134694610543944058082205618.",
                r = "9506222857810501820.";
        EXPECT_EQ(l % r, "1478108546537762758."); //61 bits
    }
    {
        Aeu512 l = "2779795750187688063983871848216183573382125177651661260363174789857794166788168456447409714653940385943131271138414270739644766856449413400622853490.",
                r = "4518484216472690867.";
        EXPECT_EQ(l % r, "1803449741656010626."); //61 bits
    }
    {
        Aeu512 l = "1218081120994759093494796628162733700285256963797356111610340045515841248930623304718036920333507322389938272652474134110754256938457073154170009367.",
                r = "16554934162804398427.";
        EXPECT_EQ(l % r, "13044508812383578218."); //64 bits
    }
    {
        Aeu512 l = "2269827336474837742246998869818273406978320811526126225648838959745793828960949197710946515947991573589687948092494321007002839420776402227896750533.",
                r = "8401596967949981869.";
        EXPECT_EQ(l % r, "2847753878309008280."); //62 bits
    }
    {
        Aeu512 l = "2837800069668177599134471275420146753310099815489424232443145767416596262160317810580205883050219174411307742404924066599211175637141955222989700918.",
                r = "6511308927063138299.";
        EXPECT_EQ(l % r, "6199222784308722030."); //63 bits
    }
    {
        Aeu512 l = "43996301878385557099090117209103403642397855406946097870528522422283321879779495167450768065441263241730266000847795987820165797527545311238966412.",
                r = "427510200594004371.";
        EXPECT_EQ(l % r, "36148586885698281."); //56 bits
    }
    {
        Aeu512 l = "2131594494165745617275649511342706288518883192317919556180497856387423163419650881084937127373899158888371833344806724396929634075387937827354333846.",
                r = "5591311761332702910.";
        EXPECT_EQ(l % r, "2882036151568967906."); //62 bits
    }
    {
        Aeu512 l = "2085563556980470035141016598197435864347311939594312470127292695637786053329613172161847758421879386320450296782295629497181271400584618064548720594.",
                r = "13754124540005502354.";
        EXPECT_EQ(l % r, "11503166447529684354."); //64 bits
    }
    {
        Aeu512 l = "1531318189434340944248419060486143627379279352962041305875102269517481778982552634313227623178953746389186067831570133626351044661101174560792022290.",
                r = "4538212021045229572.";
        EXPECT_EQ(l % r, "418793338938627342."); //59 bits
    }
    {
        Aeu512 l = "2159798277936488116182632876850709972157092316294362763583533649329185601485978209471464457078882975120080211186365672262628427530930002434516553972.",
                r = "6692974660478724042.";
        EXPECT_EQ(l % r, "6204711101687513256."); //63 bits
    }
    {
        Aeu512 l = "79756012503258850898923196936507197086543711744670028154065835507840559234511661914302279784381178880881349981637112807961311302057536559993797283.",
                r = "14847264175416817732.";
        EXPECT_EQ(l % r, "5528352928306051947."); //63 bits
    }
    {
        Aeu512 l = "412280352837188472681466147131411270875793374122749182074154435074325775353962213613011114338761426173177105413992594756414495307841475846791400356.",
                r = "3608356120571973711.";
        EXPECT_EQ(l % r, "3443863678615881163."); //62 bits
    }
    {
        Aeu512 l = "9926005497049990759740448110253039887885111919384487361677313208791887433756212239831184071217200535742517476012759329975212006955132354785518663.",
                r = "10293280990711836664.";
        EXPECT_EQ(l % r, "9524446458302469615."); //64 bits
    }
    {
        Aeu512 l = "2445902378003636938490970300614481084721626242520441446504109215511841324312840361174000503159572402708779375475414142994634638334751505096360644216.",
                r = "1610479754920620098.";
        EXPECT_EQ(l % r, "135597429805088362."); //57 bits
    }
    {
        Aeu512 l = "443070904248693804381338814049910298796857826283004215874000869351071072772580297069757736994996430325629533194876516978190158100949671845836649668.",
                r = "3473454646354323424.";
        EXPECT_EQ(l % r, "216141224596489348."); //58 bits
    }
    {
        Aeu512 l = "8422692056597443029283969963445154454969812790969000123912487885554682389781701337596796481385545956644364149509444245964681867478229634085282764.",
                r = "10881680530775258003.";
        EXPECT_EQ(l % r, "9434166386005661325."); //64 bits
    }
    {
        Aeu512 l = "1124927377915917511915992435847026755565330792118367045637010558864568078568601171541812113273690697342971722029934509507265548061830532263757160625.",
                r = "18007383581901667533.";
        EXPECT_EQ(l % r, "2016864483020128303."); //61 bits
    }
    {
        Aeu512 l = "507676424144635628769213689209424286470692499383313213203654803524580984062230708123784283069480238837658338738613699385286157668894357550783977119.",
                r = "12559728194048529398.";
        EXPECT_EQ(l % r, "34294590837756821."); //55 bits
    }
    {
        Aeu512 l = "3192966926533930861738943892763669336987415569947673903087926542277561872034249239511541271715673018187294059568437390396451464034100121115689639179.",
                r = "8174182228271861125.";
        EXPECT_EQ(l % r, "2784564214490676679."); //62 bits
    }
    {
        Aeu512 l = "2432326147411728279089833617233442736217454740303039395837214252126511775588597054257235249520302861720012585636051133110115847381259418104086545654.",
                r = "3313859306339367381.";
        EXPECT_EQ(l % r, "2399297425308340289."); //62 bits
    }
    {
        Aeu512 l = "2237244756144506914265907825799870151612306089568525592629729364944838588330724497302175279949127595883793671224519383312715349083459994529659008087.",
                r = "10666496270799494975.";
        EXPECT_EQ(l % r, "8803825541854116087."); //63 bits
    }
    {
        Aeu512 l = "208378526406954948400331293344032741761362145409298313197408571931420949055987071877013358478823706803464408077029570485104712162111390635952922917.",
                r = "6343445452071750081.";
        EXPECT_EQ(l % r, "2793085830903099319."); //62 bits
    }
    {
        Aeu512 l = "1430935771017928770738114758557506432656001404401688931656428725016822388291313488673571505791106918537990653357841801096056747786938419800371265327.",
                r = "11612190817750412623.";
        EXPECT_EQ(l % r, "1546899206755862162."); //61 bits
    }
    {
        Aeu512 l = "2327104868974326798828024575163290319803586213974273637770923987236047578920231667855066181482017030675313594341340442207439795016272792177522073099.",
                r = "578360916072763346.";
        EXPECT_EQ(l % r, "164467849199703251."); //58 bits
    }
    {
        Aeu512 l = "2186808571651189864554890823232261957487704452997071627642703479409206400922216889532508697264949370808965310568793402184616254335880716512822493092.",
                r = "5514113569234692157.";
        EXPECT_EQ(l % r, "154766385269736039."); //58 bits
    }
    {
        Aeu512 l = "1938506502891806851672348343532009213314948366341068083950506466665722118069299002478284319144772433923893868939490534374240239605019927935259064123.",
                r = "12475233575359154977.";
        EXPECT_EQ(l % r, "2473592476066687957."); //62 bits
    }
    {
        Aeu512 l = "969606471321630101100424983445119387326188597740202426245961443056072543423577483678038693656836447356544327530480913301925697958749023473606011742.",
                r = "17843222349677720446.";
        EXPECT_EQ(l % r, "3950012226875738872."); //62 bits
    }
    {
        Aeu512 l = "1055652045716616314173741672960990609756261256775334450580557203662419026165618391867963568438436715119867075622733112311022264017638548510881645334.",
                r = "1565390862550119960.";
        EXPECT_EQ(l % r, "94720493889812694."); //57 bits
    }
    {
        Aeu512 l = "3101062758739598623517537383941293385466973511516219134315812529212247491398243810164258221091351979380046656215120790449726213539907810853176563329.",
                r = "4517607898901007422.";
        EXPECT_EQ(l % r, "1351028075838844935."); //61 bits
    }
    {
        Aeu512 l = "714520706655773351521455516208468498814287668492072428403744026820410078719664865040164944822244627945236886827482848191380656741792032651576059013.",
                r = "15751516110199979539.";
        EXPECT_EQ(l % r, "2397910467310041967."); //62 bits
    }
    {
        Aeu512 l = "3152368808059362051983303486712653117887507863960444334271730539303829836966649395131312675147263806520266498418989304546042215771799412850502846031.",
                r = "5546640411107666570.";
        EXPECT_EQ(l % r, "1511155579426108581."); //61 bits
    }
    {
        Aeu512 l = "1061687432708834085864181387421416088714428790373911704596607611258135730062899913470879326406105790189829458468043828195351330679705694794025563654.",
                r = "15523544649684038954.";
        EXPECT_EQ(l % r, "15143660177742935690."); //64 bits
    }
}

TEST(Unsigned_Modulo, HugeAssignment) {
    {
        Aeu512 l = "2151938434192415145579751708926490132935797928070425617291102866202879281258310823134668670586706134684879999165104800873826978749700226883770345636.",
                r = "8815236785344484283.";
        l %= r; EXPECT_EQ(l, "8484932845198839036."); //63 bits
    }
    {
        Aeu512 l = "2954549701698434354287804402277426337967565832571948501383404823767157583845673606981783003654026996730909152982219461645307368642805179251498348237.",
                r = "3148116908630218748.";
        l %= r; EXPECT_EQ(l, "1558879796351276145."); //61 bits
    }
    {
        Aeu512 l = "3120586446712822893004242097630402056101416067580752091712890529804275779954416986126354037678196003500624032095112039524074468443342976437167271642.",
                r = "3098490595396959404.";
        l %= r; EXPECT_EQ(l, "1098507153135750498."); //60 bits
    }
    {
        Aeu512 l = "2315755170844866740849565829718682774153161131435141096391672022108054296682311494762983229153953009316274707078879589340105174781794924941452911891.",
                r = "15443308687950153778.";
        l %= r; EXPECT_EQ(l, "13909546112518750433."); //64 bits
    }
    {
        Aeu512 l = "2502493088578574276182300242235096463546384366633237635898194352915203728326003986786814120011893004622341988568243318893768451888503478856186782439.",
                r = "162948060028847774.";
        l %= r; EXPECT_EQ(l, "143015547768979615."); //57 bits
    }
    {
        Aeu512 l = "651938390673337113294844453599956105628197919887306318885526031674552161901172025364427489020518935321437941459833799049536675542625449772513443741.",
                r = "9864434102181645291.";
        l %= r; EXPECT_EQ(l, "5566948412691924400."); //63 bits
    }
    {
        Aeu512 l = "1986501237761171093187490714881943280437594997012584392438069769824611626202315167864558494434930759990875318966782843412822838832538785838184055739.",
                r = "17194375183091612471.";
        l %= r; EXPECT_EQ(l, "10984699734903574607."); //64 bits
    }
    {
        Aeu512 l = "769981112053400394871326123117425450757417538046817386205473136525476473368275949810546872470694634080619232596072379989936808271686549128333366396.",
                r = "12330113289468355757.";
        l %= r; EXPECT_EQ(l, "11805377028641748671."); //64 bits
    }
    {
        Aeu512 l = "1351974803908611456217320703614060019914446116466275269122510287343261939235635152455957144882707256453399016271972279789912859422459619068896490683.",
                r = "7182012889433610760.";
        l %= r; EXPECT_EQ(l, "6966733110578101043."); //63 bits
    }
    {
        Aeu512 l = "1383271707623873790157514545725143275477902131767916330024464084109665009764753902529489507363784771695612692489007644935760597205757118931340671950.",
                r = "5635487481221450310.";
        l %= r; EXPECT_EQ(l, "1641575144118254690."); //61 bits
    }
    {
        Aeu512 l = "2070927986815789515512233563736714464639196875629660378332816862548386943613713960945004416199596034211784345542371987940195927453873769938519243313.",
                r = "6346578325211469035.";
        l %= r; EXPECT_EQ(l, "2935092230633977483."); //62 bits
    }
    {
        Aeu512 l = "2621358545087251793344007835068446604157831565102645204896378439371877765824138555711240740172186458742100023005690595206131100144566518513003148684.",
                r = "1784395161332899247.";
        l %= r; EXPECT_EQ(l, "1137953712582436696."); //60 bits
    }
    {
        Aeu512 l = "1664036715762196978357352132237281690720378024681466501315623380582615336392704265921348873258369675405668316413276440906133916750834031670751061375.",
                r = "4174929453628567442.";
        l %= r; EXPECT_EQ(l, "3417532093792261779."); //62 bits
    }
    {
        Aeu512 l = "2735688523308886313788959405766669065474268085740969741771170625950769927847946734405729205641827496767544420172253139436092938156522767834015645134.",
                r = "689715837082982026.";
        l %= r; EXPECT_EQ(l, "32665160262320558."); //55 bits
    }
    {
        Aeu512 l = "2770977937638952953953673490275560299921821317478071711171536019141819849861975781985260204952733294990283607078844182679303655343254798397310076365.",
                r = "2193868692130062439.";
        l %= r; EXPECT_EQ(l, "2013322746114166415."); //61 bits
    }
    {
        Aeu512 l = "1774776102394127824431696009421284262773886872114265662776678202476120145085817281345711560388213458699787191560941402156774999346772904599598925395.",
                r = "6483628532895335127.";
        l %= r; EXPECT_EQ(l, "1835426406409919443."); //61 bits
    }
    {
        Aeu512 l = "1183630522458448177638569667869243849744375976219488331199910158763491951017735965924913904455769587235552439532354299977846149097467440133945919164.",
                r = "13383428964087956323.";
        l %= r; EXPECT_EQ(l, "9753456403910735936."); //64 bits
    }
    {
        Aeu512 l = "836210662006320551697467299850422493445673081032791971038975355824460326348113347301499612809314637158788559397140328502728247458268024513524964016.",
                r = "15294993952015123908.";
        l %= r; EXPECT_EQ(l, "634281179557929304."); //60 bits
    }
    {
        Aeu512 l = "1051342542584703336162077229276143885812018547325632776704349548271170305895577624023270405999754152729960107523701866186371510984617925683557231085.",
                r = "12724277763368337468.";
        l %= r; EXPECT_EQ(l, "5827978429677599117."); //63 bits
    }
    {
        Aeu512 l = "1668852509211129613625225089686805633944954473973628979718395014917084385163415874295331855531133722241818648825250009918348062973382889561459789456.",
                r = "16676094301668063166.";
        l %= r; EXPECT_EQ(l, "8784978701332448610."); //63 bits
    }
    {
        Aeu512 l = "3098083115470065000635982305413324425966293440429240981878552536793792387463018659612880455841410664312132907063516155154321345766843736932596598735.",
                r = "9668160318359313366.";
        l %= r; EXPECT_EQ(l, "4538287735474759851."); //62 bits
    }
    {
        Aeu512 l = "1848634929184558899791727214803508482048908528534382245283614509661118294469292656072941024031615400757743514855453532396241768578978144381275395920.",
                r = "15728160170898299602.";
        l %= r; EXPECT_EQ(l, "1070185663998748592."); //60 bits
    }
    {
        Aeu512 l = "503354087827061123530784768545743590448976965483667781345930362035915166420893580165014925687563969315831170103397098729349892868520673902174336708.",
                r = "9153462928042739549.";
        l %= r; EXPECT_EQ(l, "4308456273805769419."); //62 bits
    }
    {
        Aeu512 l = "1230622304231092072686051440813824379836627261295742906488260065487649724908825754112956299568891540082011362206349754728331847877276270265244068409.",
                r = "5438734440083815890.";
        l %= r; EXPECT_EQ(l, "4040353640200894339."); //62 bits
    }
    {
        Aeu512 l = "1628851072390162193569809374852745640054476040538510085037223038552359327772288839324933013593971555308509665879498860693517070307286353888072733544.",
                r = "12609374148123457752.";
        l %= r; EXPECT_EQ(l, "9628580382983266896."); //64 bits
    }
    {
        Aeu512 l = "2391089283023208028733258131378136731946031636755578016830012815229914409339419323699655923953941727850982473768483686698101654364636647195078548692.",
                r = "16977867493636627303.";
        l %= r; EXPECT_EQ(l, "15858910506695375046."); //64 bits
    }
    {
        Aeu512 l = "145664768803587209714111531398172519112936815963045323617715696052044743228280858717553529231044724773819699438672049470719861546774739181912354902.",
                r = "14360854559731914846.";
        l %= r; EXPECT_EQ(l, "13601216980963694864."); //64 bits
    }
    {
        Aeu512 l = "2681516973928184595675286611211473476071935665484631041409396251079234955913214294305517747378525063776392175929509702220068565978341144484611512335.",
                r = "1973531779765370590.";
        l %= r; EXPECT_EQ(l, "188498104147654645."); //58 bits
    }
    {
        Aeu512 l = "2562528579190342303822221395513985232281222738149785291221011968990288062500488712409663515212856812643288006111431738193525343737087570664125048301.",
                r = "9274444127142766329.";
        l %= r; EXPECT_EQ(l, "7593310638373883904."); //63 bits
    }
    {
        Aeu512 l = "1820986719045876434133081488566396238556365974616899846416305800997889291913242807061451580152350117184914450625428881010768886521120909973515314246.",
                r = "5806400084182753149.";
        l %= r; EXPECT_EQ(l, "3273741836173295382."); //62 bits
    }
    {
        Aeu512 l = "2670136380560511256697310160460283084952194118154495568516660014578614962999743518386896659328733710058593164032675103325201829144512966173582298466.",
                r = "16172578300776575874.";
        l %= r; EXPECT_EQ(l, "9194485772907276638."); //63 bits
    }
    {
        Aeu512 l = "1343313294174784145262980052294803501790742845696046290155937287315825358926768412047072877789162184156368181624127046125236586035901441457744432513.",
                r = "15242750593757457261.";
        l %= r; EXPECT_EQ(l, "5200029627568887900."); //63 bits
    }
    {
        Aeu512 l = "810543790102156450093773846814119811692887329232742485806910014250604568943471977029014756428443101958214291877618738828189393156295369671702609814.",
                r = "10352768406081561189.";
        l %= r; EXPECT_EQ(l, "4758435507893949042."); //63 bits
    }
    {
        Aeu512 l = "1453462855882134257683075404735909870939063409338382513729107985920336301036296640800970745259759614424789219379544243413642796122739018414794942760.",
                r = "18058995162812435812.";
        l %= r; EXPECT_EQ(l, "1518347884130197096."); //61 bits
    }
    {
        Aeu512 l = "589110548623713927195234016106216698401282080967313669819047509012288798918989463134411990279943113555991271686539927327702690192154238115146771456.",
                r = "3070730816448353085.";
        l %= r; EXPECT_EQ(l, "2410932612327873621."); //62 bits
    }
    {
        Aeu512 l = "2972441075570642582917396727603116396452344718600703649397941847320940421167346511797054255459569820220347649115996150402669192921782370188034848971.",
                r = "1930795178979017660.";
        l %= r; EXPECT_EQ(l, "636845361751190671."); //60 bits
    }
    {
        Aeu512 l = "949721151660361138557678795539310651438177116099598846973189760927607156651167930650461751270232866318237636684375887162432783614157897998373380656.",
                r = "10020636607996850129.";
        l %= r; EXPECT_EQ(l, "5657368970595077265."); //63 bits
    }
    {
        Aeu512 l = "1343516150953651808227484407627077822584493764778837893142845179429325497597236396838217936424469610716489236708912874842142685502160354091547388471.",
                r = "16923649988790221586.";
        l %= r; EXPECT_EQ(l, "4845624548835741127."); //63 bits
    }
    {
        Aeu512 l = "468868778752728048831330672998014345370325546139257554054488533367339238904101167962729800258106645131350962784780782933177949246491279149469529010.",
                r = "4183136147930382278.";
        l %= r; EXPECT_EQ(l, "3309646271599595558."); //62 bits
    }
    {
        Aeu512 l = "84101861521836350635716557223632637210418714487907293355331062088816475332513212680603042408754394591686086945768719372834100364406795505869402141.",
                r = "16361070171300266130.";
        l %= r; EXPECT_EQ(l, "9877782670433183671."); //64 bits
    }
}